title: "4.0"
path: 4-0
cards: []
type: sections
max_columns: 6
sections:
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: binary_sensor.vkhodnoi_zamok
                state_not: "23232"
            chip:
              type: template
              icon: >-
                {% if is_state('binary_sensor.vkhodnoi_zamok', 'off') %} 
                   {% if is_state('binary_sensor.zamok_indoor_contact', 'off')%} mdi:account-lock
                   {% else %} mdi:lock
                   {% endif %}
                {% elif is_state('binary_sensor.vkhodnoi_zamok', 'on') %}
                mdi:lock-open-variant
                      {% else %} mdi:alert-circle
                      {% endif %}
              picture: ""
              tap_action:
                action: more-info
              hold_action:
                action: none
              double_tap_action:
                action: none
              entity: binary_sensor.vkhodnoi_zamok
          - type: conditional
            conditions:
              - condition: state
                entity: input_boolean.ne_bespokoit
                state: "on"
            chip:
              type: template
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              icon: fas:moon
              entity: input_boolean.ne_bespokoit
          - type: conditional
            conditions:
              - condition: state
                entity: binary_sensor.router_master
                state_not: unavailable
            chip:
              type: template
              icon: >-

                {% if is_state('binary_sensor.router_master', 'on') %}
                mdi:web-check

                {% else %} mdi:web-cancel

                {% endif %}
              icon_color: ""
              content: ""
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color: 
                  }
              entity: binary_sensor.router_master
          - type: conditional
            conditions:
              - entity: sensor.kolichestvo_liudei
                state_not: "0"
            chip:
              type: template
              icon: mdi:home-account
              content: |2-
                    {% set total = states('zone.home')|float(0) %}

                    {% if total > 0%} {{total |float(0) | round() }} Дома
                    {% else %} Никого нет
                    {% endif %}
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
              icon_color: |2-
                    {% set total = states('zone.home')|float(0) %}

                    {% if total > 0%} {{total |float(0) | round() }} 
                    {% else %} disabled
                    {% endif %}
              card_mod:
                style: |
                  ha-card {
                    --text-color: 
                    {% set total = states('zone.home')|float(0) %}

                    {% if total > 0%} 
                    {% else %} gray
                    {% endif %}

                  }
              entity: sensor.kolichestvo_liudei
          - type: conditional
            conditions:
              - condition: state
                entity: person.melkaia
                state_not: home
            chip:
              type: template
              picture: ""
              icon: mdi:face-woman
              content: |2-
                      {% set x = states(config.entity) %}   {% set y =
                      state_attr('sensor.iphone_valeriia_geocoded_location', 'Locality' ) %}  
                      {% set z = state_attr('sensor.iphone_valeriia_geocoded_location', 'Name') 
                      %} {% if states.person.melkaia.state ==
                      states.input_text.rabota_melkaia.state %} На работе  {% elif
                      is_state(config.entity, 'home') %} Дома  {% elif is_state(config.entity,
                      'В Кураже') %} В Кураже   {% elif is_state(config.entity, 'Дом Мелкой') %}
                      У Мамы   {% elif is_state(config.entity, 'not_home') %}  
                       {% if is_state_attr('sensor.iphone_valeriia_geocoded_location', 'Locality', 'Волжский' ) %} {{z|string|truncate(50, True, '...', 0)|replace ("'","")|replace ("(","")|replace(")","")}}  
                       {% else %} {{y|string|truncate(50, True, '...', 0)|replace ("'","")|replace ("(","")|replace(")","")}} 
                       {% endif %}
                      {% else %} {{states(config.entity)}}   {% endif %}
              tap_action:
                action: more-info
              hold_action:
                action: none
              double_tap_action:
                action: none
              entity: person.melkaia
          - type: conditional
            conditions:
              - condition: state
                entity: weather.iandeks_pogoda
                state_not: unavailable
            chip:
              type: template
              icon: >-
                {% if is_state(config.entity, 'rainy') %} mdi:umbrella

                {% elif is_state(config.entity, 'cloudy') %} mdi:weather-cloudy

                {% elif is_state(config.entity, 'hail') %} mdi:weather-hail

                {% elif is_state(config.entity, 'snowy') %} mdi:weather-snowy

                {% elif is_state(config.entity, 'sunny') %} mdi:weather-sunny

                {% elif is_state(config.entity, 'lightning') %}
                mdi:weather-lightning

                {% elif is_state(config.entity, 'windy') %} mdi:weather-windy

                {% elif is_state(config.entity, 'partlycloudy') %}
                mdi:weather-partly-cloudy

                {% elif is_state(config.entity, 'clear-day') %}
                mdi:white-balance-sunny

                {% elif is_state(config.entity, 'clear-night') %}
                mdi:weather-night

                {% elif is_state(config.entity, 'rain') %} mdi:weather-pouring

                {% elif is_state(config.entity, 'snow') %}
                mdi:weather-snowy-heavy

                {% elif is_state(config.entity, 'sleet') %}
                mdi:weather-snowy-rainy

                {% elif is_state(config.entity, 'wind') %} mdi:weather-dust  

                {% elif is_state(config.entity, 'fog') %} mdi:weather-fog

                {% elif is_state(config.entity, 'thunderstorm') %}
                mdi:weather-lightning

                {% elif is_state(config.entity, 'windy-variant') %}
                mdi:weather-windy

                {% elif is_state(config.entity, 'snowy-rainy') %}
                mdi:weather-snowy-rainy

                {% elif is_state(config.entity, 'pouring') %}
                mdi:weather-pouring

                  {% else %} mdi:weather-cloudy-clock
                  {% endif %}
              content: >
                {% if is_state(config.entity,'unavailable')%} Недоступно

                {% else %}{{state_attr(config.entity, 'temperature')|float(0) |
                round()}}°

                {% endif %}
              double_tap_action:
                action: none
              tap_action:
                action: more-info
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color: 

                  }
              icon_color: ""
              entity: weather.iandeks_pogoda
          - type: conditional
            conditions:
              - entity: sensor.ble_temperature_a4c1387e6730
                state_not: unavailable
            chip:
              type: template
              icon: mdi:thermometer
              icon_color: ""
              content: "{{states('sensor.temp_home')}}"
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color: 

                  }
              entity: sensor.ble_temperature_a4c1387e6730
          - type: template
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            entity: sensor.diapazon_iarkost_doma_dlia_dashborda
            content: "{{states('sensor.diapazon_iarkost_doma_dlia_dashborda')}}"
            icon_color: ""
            icon: mdi:white-balance-sunny
          - type: conditional
            conditions:
              - entity: automation.budilnik_2
                state: "on"
            chip:
              type: template
              icon: mdi:alarm
              content: >-
                {{state_attr('input_datetime.vremia', 'hour')}}:{% if
                state_attr('input_datetime.vremia', 'minute') < 10
                %}0{{state_attr('input_datetime.vremia', 'minute')}}

                {% else %}{{state_attr('input_datetime.vremia', 'minute')}}

                {% endif %}
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color:
                  }
              icon_color: null
              entity: automation.budilnik_2
          - type: conditional
            conditions:
              - condition: state
                entity: binary_sensor.budilnik_stantsiia_mini
                state: "on"
            chip:
              type: template
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              icon: mdi:alarm
              content: >-
                {% if
                state_attr('calendar.yandex_station_m00en2100jayck_calendar','start_time')
                is none %}

                {% else %} 

                {%- set date =
                (as_timestamp('calendar.yandex_station_m00en2100jayck_calendar','start_time'))|float(0)
                -%}

                {% set day_now = as_timestamp(now()) |timestamp_custom('%d')|int
                %}

                {% set day =
                as_timestamp(state_attr('calendar.yandex_station_m00en2100jayck_calendar','start_time'))|timestamp_custom('%-d')
                %}

                {%- set month_list =
                ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря']
                %}

                {%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}

                {%- set month = month_list[m_ok-1] %}

                {% set month_int = as_timestamp(now())
                |timestamp_custom('%m')|int %}

                {% set month_now = as_timestamp(now())
                |timestamp_custom('%m')|int %}

                {% set time =
                as_timestamp(state_attr('calendar.yandex_station_m00en2100jayck_calendar','start_time'))
                |timestamp_custom('%H:%M') %}

                {% endif %}


                {% if
                state_attr('calendar.yandex_station_m00en2100jayck_calendar','start_time')
                is none %} Не установлен

                {% else %} 


                {% if (day == day_now ) and (month_now == month_int)%} Сегодня

                {% elif day|int - day_now|int == 1%} Завтра

                 {% else %} {{day}} {{month}}
                 {% endif %}
                 в {{ time }}
                {% endif %}
              entity: binary_sensor.budilnik_stantsiia_mini
          - type: conditional
            conditions:
              - condition: state
                entity: automation.budilnik_po_kalendariu_melkaia
                state: "on"
            chip:
              type: template
              icon: mdi:alarm-multiple
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              entity: automation.budilnik_po_kalendariu_melkaia
              content: >-
                {% set sec = state_attr('input_datetime.melkaya_wake_time',
                'hour') * 60 +  state_attr('input_datetime.melkaya_wake_time',
                'minute') %}

                {% if is_state('automation.budilnik_po_kalendariu_melkaia',
                'on') %}
                  {% if((now().date() + timedelta(days=1)) == as_datetime(state_attr('calendar.work_m', 'start_time')).date()) == True %} Завтра в {{as_timestamp((as_datetime(state_attr('calendar.work_m', 'start_time'))) - timedelta(minutes=sec))| timestamp_custom('%H:%M') }}  
                  {% elif as_timestamp((state_attr('calendar.work_m', 'start_time')))| timestamp_custom('%H:%M') < as_timestamp(now()) | timestamp_custom('%H:%M') and ((now().date() + timedelta(days=0)) == as_datetime(state_attr('calendar.work_m', 'start_time')).date()) == True%}
                  {% elif((now().date() + timedelta(days=0)) == as_datetime(state_attr('calendar.work_m', 'start_time')).date()) == True and as_timestamp((state_attr('calendar.work_m', 'start_time')))| timestamp_custom('%H:%M') > as_timestamp(now()) | timestamp_custom('%H:%M') %} Сегодня в {{as_timestamp((as_datetime(state_attr('calendar.work_m', 'start_time'))) - timedelta(minutes=sec))| timestamp_custom('%H:%M') }}  
                  {% else %} {{ (as_timestamp(state_attr('calendar.work_m', 'start_time'))|timestamp_custom('%d.%m')) }}   
                  {% endif %} 
                {% else %} Выкл

                {% endif %}
          - type: conditional
            conditions:
              - entity: light.svet_vezde
                state_not: "off"
            chip:
              type: template
              icon: mdi:lightbulb
              content: >
                {% if is_state('sensor.count_lights_all', '0') %} Всё выключено

                {% elif is_state('sensor.count_lights_all', '1') %}
                {{states('sensor.count_lights_all')|float(0) | round()}}
                Включена

                {% else %} {{states('sensor.count_lights_all')|float(0) |
                round()}} Включено

                {% endif%}
              icon_color: |
                {% if is_state('sensor.count_lights_all', '0') %} disabled
                {% else %} 
                {% endif%}
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color: 
                    {% if is_state('sensor.svet_v_kvartire', '0') %} gray

                    {% else %} 

                   {% endif%}
                  }
              entity: light.svet_vezde
          - type: conditional
            conditions:
              - entity: switch.girliandy
                state: "on"
              - condition: state
                entity: input_boolean.kanun_novogo_goda
                state: "on"
            chip:
              type: template
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              icon: mdi:string-lights
              content: >
                {% set x = (expand(states.switch.girliandy) |
                selectattr('state', 'eq', 'on') | map(attribute='entity_id') |
                list | count)  %}

                {{x}}

                {% if x == 1 %} Включена

                {% else %} Включено

                {% endif%}
              entity: switch.girliandy
          - type: conditional
            conditions:
              - entity: fan.ac_switch
                state_not: "off"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: |-
                {% if is_state('climate.ac_fan', 'cool') %} mdi:snowflake
                {% elif is_state('climate.ac_fan', 'heat') %} mdi:heat-wave
                {% elif is_state('climate.ac_fan', 'auto') %} mdi:fan-auto
                {% elif is_state('climate.ac_fan', 'dry') %} mdi:water-opacity
                {% endif %}
              content: >-
                {% if is_state('climate.ac_fan', 'cool')%} Охлаждение до

                {% elif is_state('climate.ac_fan', 'on')%} Охлаждение до

                {% elif is_state('climate.ac_fan', 'heat')%} Обогрев до

                {% elif is_state('climate.ac_fan', 'auto')%} Авто-режим

                {% elif is_state('climate.ac_fan', 'dry')%} Осушение

                {% else %} Включен

                {% endif %}


                {% if is_state('climate.ac_fan', 'cool')%}
                {{state_attr('climate.ac_fan', 'temperature')}}°

                {% elif is_state('climate.ac_fan', 'heat')%}
                {{state_attr('climate.ac_fan', 'temperature')}}°

                {% elif is_state('climate.ac_fan', 'on')%}
                {{state_attr('climate.ac_fan', 'temperature')}}°

                {% endif %}
              tap_action:
                action: more-info
              hold_action:
                action: none
              entity: climate.ac_fan
          - type: conditional
            conditions:
              - entity: media_player.gostinaia
                state: playing
            chip:
              type: template
              icon: bha:apple-tv
              content: |2-

                  {% if is_state_attr('media_player.gostinaia', 'app_id', 'ru.kinopoisk')%} Кинопоиск
                  {% elif is_state_attr('media_player.gostinaia', 'app_id', 'com.google.ios.youtube')%} YouTube
                  {% elif is_state_attr('media_player.gostinaia', 'app_id', 'com.apple.TVAirPlay')%} AirPlay
                  {% elif is_state_attr('media_player.gostinaia', 'app_id', 'com.apple.TVWatchList')%} AppleTV+
                  {% elif is_state_attr('media_player.gostinaia', 'app_id', 'com.apple.TVMusic')%} {{state_attr('media_player.gostinaia', 'media_artist')}} - {{state_attr('media_player.gostinaia', 'media_title')}}
                  {% elif is_state_attr('media_player.gostinaia', 'app_id', 'org.videolan.vlc-ios')%} VLC
                  {% else %} {{state_attr('media_player.gostinaia', 'app_name')}}
                  {% endif %}
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color: 

                  }
              icon_color: ""
              entity: media_player.gostinaia
          - type: conditional
            conditions:
              - entity: media_player.televizor
                state: "on"
              - entity: media_player.gostinaia
                state_not: playing
            chip:
              type: template
              icon: bha:apple-tv
              content: Включено
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
              icon_color: ""
              card_mod:
                style: |
                  ha-card {
                    --text-color: 
                  }
              entity: media_player.gostinaia
          - type: conditional
            conditions:
              - entity: media_player.yandex_station_m00en2100jayck
                state: playing
              - entity: binary_sensor.multirum_sostoianie
                state: "off"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: yandex:station-mini-2
              icon_color: ""
              content: >-
                {{state_attr('media_player.yandex_station_m00en2100jayck',
                'media_artist')}} -
                {{state_attr('media_player.yandex_station_m00en2100jayck',
                'media_title')}}
              picture: ""
              tap_action:
                action: none
              hold_action:
                action: none
              entity: media_player.yandex_station_m00en2100jayck
          - type: conditional
            conditions:
              - entity: media_player.yandex_station_purple
                state: playing
              - entity: binary_sensor.multirum_sostoianie
                state: "off"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: yandex:station-lite
              icon_color: ""
              content: >-
                {{state_attr('media_player.yandex_station_purple',
                'media_artist')}} -
                {{state_attr('media_player.yandex_station_purple',
                'media_title')}}
              picture: ""
              tap_action:
                action: none
              hold_action:
                action: none
              entity: media_player.yandex_station_purple
          - type: conditional
            conditions:
              - entity: media_player.yandex_station_beige
                state: playing
              - entity: binary_sensor.multirum_sostoianie
                state: "off"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: yandex:station-lite
              icon_color: ""
              content: >-
                {{state_attr('media_player.yandex_station_beige',
                'media_artist')}} -
                {{state_attr('media_player.yandex_station_beige',
                'media_title')}}
              picture: ""
              tap_action:
                action: none
              hold_action:
                action: none
              entity: media_player.yandex_station_beige
          - type: conditional
            conditions:
              - entity: binary_sensor.multirum_sostoianie
                state: "on"
              - condition: state
                entity: media_player.yandex_station_m00en2100jayck
                state: playing
            chip:
              type: template
              icon: yandex:station-mini-2-stereo
              icon_color: ""
              content: >-
                {{state_attr('media_player.yandex_station_m00en2100jayck',
                'media_artist')}} -
                {{state_attr('media_player.yandex_station_m00en2100jayck',
                'media_title')}}
              double_tap_action:
                action: none
              tap_action:
                action: navigate
                navigation_path: /dashboard-iphone/multiroom
              hold_action:
                action: none
              entity: binary_sensor.multirum_sostoianie
          - type: conditional
            conditions:
              - condition: state
                entity: switch.polaris_kettle
                state: "on"
            chip:
              type: template
              icon: "{{state_attr(config.entity, 'icon')}}"
              content: >-
                Включен • {{state_attr('water_heater.polaris_kettle',
                'current_temperature')}}°
              card_mod:
                style: |
                  ha-card {
                    --text-color: 
                  }
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              entity: water_heater.polaris_kettle
          - type: conditional
            conditions:
              - entity: binary_sensor.dveri
                state: "on"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: fas:door-open
              icon_color: ""
              content: |-
                {{states('sensor.count_open_doors')}}
                {% if states('sensor.count_open_doors') == '1' %} Открыта 
                {% else %} Открыто
                {% endif %}
              tap_action:
                action: none
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color: 
                  }
              entity: binary_sensor.dveri
          - type: conditional
            conditions:
              - entity: binary_sensor.okna
                state: "on"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: mdi:window-open-variant
              icon_color: ""
              content: |-
                {{states('sensor.count_open_windows')}}
                {% if states('sensor.count_open_windows') == '1' %} Открыто 
                {% else %} Открыто
                {% endif %}
              tap_action:
                action: none
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color: 
                  }
              entity: binary_sensor.okna
          - type: conditional
            conditions:
              - entity: binary_sensor.holodilnik_contact
                state: "on"
            chip:
              type: template
              icon: mdi:fridge-bottom
              content: Открыто
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              entity: binary_sensor.holodilnik_contact
          - type: conditional
            conditions:
              - entity: binary_sensor.open_morozilka_contact
                state: "on"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: mdi:fridge-top
              icon_color: ""
              content: Открыто
              tap_action:
                action: none
              hold_action:
                action: none
              entity: binary_sensor.open_morozilka_contact
          - type: conditional
            conditions:
              - entity: binary_sensor.washing_machine
                state: "on"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: mdi:washing-machine
              content: |-

                Стирка
                {% if is_state('timer.washing', 'active')%} •
                  {% set x = state_attr('timer.washing','finishes_at') %}
                  {% set y = as_timestamp(x) - as_timestamp(now()) %}
                   {% if y > 3600 %} более часа
                   {% elif y > 69 %} около {{(y + 30)|int(0)|timestamp_custom('%-M') }} мин.
                   {% else %} менее минуты
                   {% endif %}

                {% else %} 
                {% endif %}
              tap_action:
                action: none
              hold_action:
                action: none
              entity: binary_sensor.washing_machine
          - type: conditional
            conditions:
              - entity: binary_sensor.open_wash_contact
                state: "on"
            chip:
              type: template
              double_tap_action:
                action: none
              icon: mdi:washing-machine
              content: Открыта
              tap_action:
                action: none
              hold_action:
                action: none
              entity: binary_sensor.open_wash_contact
          - type: conditional
            conditions:
              - entity: switch.konvektor
                state: "on"
            chip:
              type: template
              icon: mdi:heat-wave
              content: >-
                {% if
                is_state('automation.avtomaticheskii_obogrev_balkona_po_temperature','on')%}

                Обогрев балкона до
                {{states('input_number.konvektor_temperatura_maksimum',
                'temperature')| float(0) | round(0) }}°

                {% else %}

                Конвектор вкл.

                {% endif %}
              tap_action:
                action: none
              entity: switch.konvektor
              hold_action:
                action: none
              double_tap_action:
                action: none
          - type: conditional
            conditions:
              - entity: switch.tioplyi_pol
                state: "on"
            chip:
              type: template
              icon: mdi:heating-coil
              content: Тёплый пол вкл.
              tap_action:
                action: none
              hold_action:
                action: none
              double_tap_action:
                action: none
              entity: switch.tioplyi_pol
          - type: conditional
            conditions:
              - entity: binary_sensor.dvizhenie_v_kvartire
                state_not: "2343243242342"
            chip:
              type: template
              icon: >-

                {% if is_state('binary_sensor.dvizhenie_v_kvartire', 'on') %}
                mdi:run-fast

                {% else %} mdi:run

                {% endif %}
              icon_color: |-
                {% if is_state('binary_sensor.dvizhenie_v_kvartire', 'on') %} 1
                {% else %} disabled
                {% endif %}
              picture: ""
              content: >-
                {% if is_state('binary_sensor.dvizhenie_v_kvartire', 'on') %}
                Движение

                {% elif is_state('binary_sensor.dvizhenie_v_kvartire', 'off') %}
                Нет движения

                {% else %} Неизвестно

                {% endif %}
              tap_action:
                action: none
              double_tap_action:
                action: none
              hold_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color:  {{ ' ' if is_state('binary_sensor.dvizhenie_v_kvartire', 'on') else 'gray' }};

                  }
              entity: binary_sensor.dvizhenie_v_kvartire
          - type: conditional
            conditions:
              - entity: binary_sensor.dry_kuhnya_water_leak
                state_not: "343435345"
            chip:
              type: template
              content: >-
                {% if is_state('binary_sensor.dry_kuhnya_water_leak', 'on') %}
                Протечка на кухне

                {% elif is_state('binary_sensor.dry_stoyak_water_leak', 'on') %}
                Протечка в ванной

                {% elif is_state('binary_sensor.water_all', 'off') %} Сухо

                {% else %} Неизвестно

                {% endif %}
              icon_color: |-
                {% if is_state('binary_sensor.water_all', 'on') %} red
                {% else %} disabled
                {% endif %}
              icon: mdi:water
              tap_action:
                action: none
              card_mod:
                style: |
                  ha-card {
                    --text-color:  {{ ' ' if is_state('binary_sensor.water_all', 'on') else 'gray' }};

                  }
              hold_action:
                action: none
              double_tap_action:
                action: none
              entity: binary_sensor.water_all
          - type: conditional
            conditions:
              - condition: state
                entity: binary_sensor.fridge_dry_water_leak
                state: "on"
            chip:
              type: template
              entity: binary_sensor.fridge_dry_water_leak
              icon: mdi:cup-water
              icon_color: red
              content: Конденсат в холодильнике
          - type: conditional
            conditions:
              - condition: state
                entity: light.kukhnia
                state: "on"
              - condition: state
                entity: timer.svet_na_kukhne_po_dvizheniiu
                state: active
            chip:
              type: template
              content: >
                Кухня выкл.

                {% set x =
                state_attr('timer.svet_na_kukhne_po_dvizheniiu','finishes_at')
                %}
                  {% set y = as_timestamp(x) - as_timestamp(now()) %}
                   {% if y > 60 %}через {{(y + 30)|int(0)|timestamp_custom('%-M') |format(morph='минуту', as_text=false)  }} 
                   {% else %} менее чем через минуту
                   {% endif %}
              tap_action:
                action: perform-action
                perform_action: light.turn_off
                target:
                  entity_id: light.kukhnia
              hold_action:
                action: none
              double_tap_action:
                action: none
              icon: mdi:lightbulb-auto
              entity: timer.svet_na_kukhne_po_dvizheniiu
          - type: conditional
            conditions:
              - condition: state
                entity: light.prikhozhaia
                state: "on"
              - condition: state
                entity: timer.svet_v_prikhozhei_po_dvizheniiu
                state: active
            chip:
              type: template
              content: >
                Прихожая выкл.

                {% set x =
                state_attr('timer.svet_v_prikhozhei_po_dvizheniiu','finishes_at')
                %}
                  {% set y = as_timestamp(x) - as_timestamp(now()) %}
                   {% if y > 60 %}через {{(y + 30)|int(0)|timestamp_custom('%-M') |format(morph='минуту', as_text=false)  }} 
                   {% else %} менее чем через минуту
                   {% endif %}
              tap_action:
                action: perform-action
                perform_action: light.turn_off
                target:
                  entity_id: light.prikhozhaia
              hold_action:
                action: none
              double_tap_action:
                action: none
              entity: timer.svet_v_prikhozhei_po_dvizheniiu
              icon: mdi:lightbulb-auto
              icon_color: ""
        alignment: start
        grid_options:
          columns: full
        card_mod:
          style: |
            ha-card > .chip-container {
              flex-wrap: nowrap;
              overflow-x: scroll;
              overflow-y: hidden;
              --chip-background: none;
              --chip-spacing: 0px;
              --chip-height: 50px;
              --chip-font-weight: bolder; 
              --chip-font-size: 15px; 
              margin-top: 10px;   
              margin-bottom: -20px;
              padding-bottom: 10px;
            }

            ha-card > .chip-container > * {
              flex-shrink: 0;
            }
    column_span: 6
    visibility:
      - condition: screen
        media_query: "(min-width: 1280px)"
  - type: grid
    cards:
      - type: vertical-stack
        cards:
          - type: custom:mushroom-chips-card
            chips:
              - type: conditional
                conditions:
                  - entity: binary_sensor.vkhodnoi_zamok
                    state_not: "23232"
                chip:
                  type: template
                  icon: >-
                    {% if is_state('binary_sensor.vkhodnoi_zamok', 'off') %} 
                       {% if is_state('binary_sensor.zamok_indoor_contact', 'off')%} mdi:account-lock
                       {% else %} mdi:lock
                       {% endif %}
                    {% elif is_state('binary_sensor.vkhodnoi_zamok', 'on') %}
                    mdi:lock-open-variant
                          {% else %} mdi:alert-circle
                          {% endif %}
                  picture: ""
                  tap_action:
                    action: more-info
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  entity: binary_sensor.vkhodnoi_zamok
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.ne_bespokoit
                    state: "on"
                chip:
                  type: template
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  entity: input_boolean.ne_bespokoit
                  icon: fas:moon
              - type: conditional
                conditions:
                  - entity: binary_sensor.water_all
                    state: "on"
                chip:
                  type: template
                  icon: mdi:water-alert
                  icon_color: ""
                  double_tap_action:
                    action: none
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  entity: binary_sensor.water_all
              - type: template
                icon: mdi:thermometer
                content: "{{states('sensor.temp_home')}}"
                double_tap_action:
                  action: none
                tap_action:
                  action: none
                hold_action:
                  action: none
                entity: sensor.ble_temperature_a4c1387e6730
              - type: conditional
                conditions:
                  - entity: automation.budilnik_2
                    state: "on"
                chip:
                  type: template
                  icon: mdi:alarm
                  content: >
                    {% set time1 = states.input_datetime.vremia.attributes.hour
                    %}

                    {% set time2 =
                    states.input_datetime.vremia.attributes.minute %}


                    {{ time1 }}:{% if time2<10 %}0{{ time2 }}
                              {% else %}{{ time2 }}
                              {% endif %}
                  double_tap_action:
                    action: none
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  entity: automation.budilnik_2
              - type: conditional
                conditions:
                  - entity: light.svet_vezde
                    state: "on"
                chip:
                  type: template
                  icon: mdi:lightbulb
                  content: "{{ states('sensor.count_lights_all') }} вкл."
                  double_tap_action:
                    action: none
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  entity: light.svet_vezde
              - type: conditional
                conditions:
                  - condition: state
                    entity: binary_sensor.multirum_sostoianie
                    state: "on"
                  - condition: state
                    entity: media_player.yandex_station_m00en2100jayck
                    state: idle
                chip:
                  type: template
                  icon: yandex:station-mini-2-stereo
                  tap_action:
                    action: navigate
                    navigation_path: /dashboard-iphone/multiroom
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  entity: media_player.multirum_stantsii
                  content: Мультирум
              - type: conditional
                conditions:
                  - condition: state
                    entity: sensor.count_media_all
                    state_not: "0"
                chip:
                  type: template
                  content: "{{ states('sensor.count_media_all') }} вкл."
                  icon: mdi:monitor-speaker
                  double_tap_action:
                    action: none
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  entity: sensor.kolichestvo_pleerov
              - type: conditional
                conditions:
                  - condition: state
                    entity: sensor.count_climate_all
                    state_not: "0"
                chip:
                  type: template
                  double_tap_action:
                    action: none
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  icon: mdi:home-thermometer
                  content: "{{states('sensor.count_climate_all')}} вкл."
                  entity: sensor.kolichestvo_vkl_klimat
              - type: conditional
                conditions:
                  - entity: switch.girliandy
                    state: "on"
                  - condition: state
                    entity: input_boolean.kanun_novogo_goda
                    state: "on"
                chip:
                  type: template
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  icon: mdi:string-lights
                  content: >
                    {% set x = (expand(states.switch.girliandy) |
                    selectattr('state', 'eq', 'on') | map(attribute='entity_id')
                    | list | count)  %}

                    {{x}} вкл.
                  entity: switch.girliandy
              - type: conditional
                conditions:
                  - entity: switch.polaris_kettle
                    state: "on"
                chip:
                  type: template
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  icon: |2-
                     {% if state_attr(config.entity, 'current_temperature')|float(0) >= 90 %} mdi:kettle-steam
                     {% else %} mdi:kettle
                     {% endif %}
                  entity: water_heater.polaris_kettle
              - type: conditional
                conditions:
                  - entity: binary_sensor.washing_machine
                    state: "on"
                chip:
                  type: template
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  icon: mdi:washing-machine
                  entity: binary_sensor.washing_machine
                  content: |-
                    {% if is_state('timer.washing', 'active')%}
                      {% set x = state_attr('timer.washing','finishes_at') %}
                      {% set y = as_timestamp(x) - as_timestamp(now()) %}
                       {% if y > 3600 %} Более часа
                       {% elif y > 69 %} Около {{(y + 30)|int(0)|timestamp_custom('%-M') }} мин.
                       {% else %} менее минуты
                       {% endif %}

                    {% else %}
                    {% endif %}
              - type: conditional
                conditions:
                  - entity: binary_sensor.dveri
                    state: "on"
                chip:
                  type: template
                  icon: fas:door-open
                  double_tap_action:
                    action: none
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  content: "{{states('sensor.count_open_doors')}} откр."
                  entity: binary_sensor.dveri
              - type: conditional
                conditions:
                  - entity: binary_sensor.okna
                    state: "on"
                chip:
                  type: template
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  content: "{{states('sensor.count_open_windows')}} откр."
                  picture: ""
                  icon: mdi:window-open-variant
                  entity: binary_sensor.okna
              - type: conditional
                conditions:
                  - entity: binary_sensor.dvizhenie_v_kvartire
                    state: "on"
                chip:
                  type: template
                  icon: mdi:run-fast
                  double_tap_action:
                    action: none
                  tap_action:
                    action: none
                  hold_action:
                    action: none
                  entity: binary_sensor.dvizhenie_v_kvartire
              - type: conditional
                conditions:
                  - condition: state
                    entity: person.melkaia
                    state_not: home
                chip:
                  type: template
                  picture: ""
                  icon: mdi:face-woman
                  content: >-
                    {% if is_state('person.melkaia', 'home')%} Дома

                    {% elif is_state('person.melkaia', 'not_home')%}
                    {{state_attr('sensor.iphone_valeriia_geocoded_location',
                    'Locality' )}},
                    {{state_attr('sensor.iphone_valeriia_geocoded_location',
                    'Name' )}}  

                    {% elif is_state('person.melkaia', 'unavailable')%}
                    Неизвестно

                    {% elif is_state('person.melkaia', 'Дом Мелкой')%} У мамы

                    {% else %} {{states('person.melkaia')}} 

                    {% endif %}
                  tap_action:
                    action: more-info
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  entity: person.melkaia
            alignment: start
            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-background: none;
                  --chip-spacing: 0px;
                  --chip-height: 45px;
                  --chip-font-weight: bolder; 
                  --chip-font-size: 14px; 
                  margin-top: 0px;
                  margin-left: 0px;  
                  padding-bottom: 8px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {

                  height: 100%;
                  width: 100%;
                  bottom: 0px;
                  top: -10px
                  left: 0px;
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:button-pointer
                entity: calendar.work_s
                icon_color: >-
                  {% if is_state('calendar.work_s', 'unavailable') %} disabled

                  {% elif((now().date() + timedelta(days=0)) ==
                  as_datetime(state_attr('calendar.work_s',
                  'start_time')).date()) == True %}
                  {{state_attr('calendar.work_s','message')}}

                  {% elif((now().date() + timedelta(days=1)) ==
                  as_datetime(state_attr('calendar.work_s',
                  'start_time')).date()) == True %} 
                            {% else %}
                              disabled
                            {% endif %}
                content: >-
                  {% if states('calendar.work_s') == 'unknown' %}  

                  {% else %} 
                    {% if is_state('calendar.work_s', 'unavailable') %}
                    {% elif (as_timestamp(state_attr('calendar.work_s', 'start_time'))|timestamp_custom('%m %d') == now().strftime("%m %d") ) %} {{ (as_timestamp(state_attr('calendar.work_s', 'start_time'))|timestamp_custom('%H:%M')) }} -
                    {% else %}
                    {% endif %}      
                  {% endif %} 


                  {% if is_state('calendar.work_s', 'unavailable') %} Неизвестно

                  {% elif((now().date() + timedelta(days=0)) ==
                  as_datetime(state_attr('calendar.work_s',
                  'start_time')).date()) == True %}
                  {{state_attr('calendar.work_s','message')}}

                  {% elif((now().date() + timedelta(days=1)) ==
                  as_datetime(state_attr('calendar.work_s',
                  'start_time')).date()) == True %} Завтра на работу

                  {% else %} 

                  {% endif%}
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-iphone/Cal
              - type: template
                content: >-
                  {% if states('calendar.work_m') == 'unknown' %}  

                  {% else %} 
                    {% if is_state('calendar.work_m', 'unavailable') %}
                    {% elif (as_timestamp(state_attr('calendar.work_m', 'start_time'))|timestamp_custom('%m %d') == now().strftime("%m %d") ) %} {{ (as_timestamp(state_attr('calendar.work_m', 'start_time'))|timestamp_custom('%H:%M')) }} -
                    {% else %}
                    {% endif %}      
                  {% endif %} 


                  {% if is_state('calendar.work_s', 'unavailable') %} Неизвестно

                  {% elif((now().date() + timedelta(days=0)) ==
                  as_datetime(state_attr('calendar.work_m',
                  'start_time')).date()) == True %}
                  {{state_attr('calendar.work_m','message')}}

                  {% elif((now().date() + timedelta(days=1)) ==
                  as_datetime(state_attr('calendar.work_m',
                  'start_time')).date()) == True %} Завтра на работу

                  {% else %} 

                  {% endif%}
                icon_color: >-
                  {% if is_state('calendar.work_m', 'unavailable') %} disabled


                  {% elif((now().date() + timedelta(days=0)) ==
                  as_datetime(state_attr('calendar.work_m',
                  'start_time')).date()) == True %} 

                  {% elif((now().date() + timedelta(days=1)) ==
                  as_datetime(state_attr('calendar.work_m',
                  'start_time')).date()) == True %} 
                                  {% else %}
                                    disabled
                                  {% endif %}
                icon: fas:w
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-iphone/Cal
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: calendar.work_m
              - type: template
                icon: mdi:home
                icon_color: >-
                  {% if is_state('calendar.1home', 'unavailable') %} disabled

                  {% elif (as_timestamp(state_attr('calendar.1home',
                  'start_time'))|timestamp_custom('%y %m %d') ==
                  now().strftime("%y %m %d") ) %} 
                            {% else %}
                              disabled
                            {% endif %}
                content: |-
                  {% if states('calendar.1home') == 'unknown' %}   {% else %} 
                    {% if is_state('calendar.1home', 'unavailable') %} Неизвестно
                    {% elif (as_timestamp(state_attr('calendar.1home', 'start_time'))|timestamp_custom('%y %m %d') == now().strftime("%y %m %d")) %} {{state_attr('calendar.1home','message')}}
                    {% else %}
                    {% endif %}
                    {% if is_state('calendar.1home', 'unavailable') %}
                    {% elif (as_timestamp(state_attr('calendar.1home', 'start_time'))|timestamp_custom('%y %m %d') == now().strftime("%y %m %d")) %} 
                      {% if is_state_attr('calendar.1home', 'all_day', true)%} на весь день
                      {% else %} в {{ (as_timestamp(state_attr('calendar.1home', 'start_time'))|timestamp_custom('%H:%M')) }}
                      {% endif %}
                    {% else %}
                    {% endif %}

                  {% endif %}
                entity: calendar.1home
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-iphone/Cal
              - type: template
                icon: mdi:face-woman
                icon_color: >-
                  {% if is_state('calendar.melkaia', 'unavailable') %} disabled

                  {% elif (as_timestamp(state_attr('calendar.melkaia',
                  'start_time'))|timestamp_custom('%y %m %d') ==
                  now().strftime("%y %m %d") ) %} 
                            {% else %}  disabled
                            {% endif %}
                content: |-
                  {% if states('calendar.melkaia') == 'unknown' %}   {% else %} 
                    {% if is_state('calendar.melkaia', 'unavailable') %} Неизвестно
                    {% elif (as_timestamp(state_attr('calendar.melkaia', 'start_time'))|timestamp_custom('%y %m %d') == now().strftime("%y %m %d")) %} {{state_attr('calendar.melkaia','message')}}
                    {% else %}
                    {% endif %}
                    {% if is_state('calendar.melkaia', 'unavailable') %}
                    {% elif (as_timestamp(state_attr('calendar.melkaia', 'start_time'))|timestamp_custom('%y %m %d') == now().strftime("%y %m %d")) %} 
                      {% if is_state_attr('calendar.melkaia', 'all_day', true)%} на весь день
                      {% else %} в {{ (as_timestamp(state_attr('calendar.melkaia', 'start_time'))|timestamp_custom('%H:%M')) }}
                      {% endif %}
                    {% else %}
                    {% endif %}

                  {% endif %}
                entity: calendar.melkaia
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-iphone/Cal
              - type: template
                icon_color: |-
                  {% if is_state('calendar.5birthday', 'on') %} 
                            {% else %}
                              disabled
                            {% endif %}
                icon: mdi:gift
                content: >-
                  {% if states('calendar.5birthday') == 'unknown' %}  {% else %}
                  {% if is_state('calendar.5birthday', 'unavailable') %}
                  Неизвестно

                  {% elif is_state('calendar.5birthday', 'on') %}
                  {{state_attr('calendar.5birthday','message')}}

                            {% else %}
                              
                            {% endif %}
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-iphone/Cal
                entity: calendar.5birthday
            card_mod:
              style:
                mushroom-template-chip:nth-child(1)$: |
                  span:after {
                    content: '{% if is_state('calendar.work_s', 'unavailable') %} Неизвестно{% elif (((now().date() + timedelta(days=0)) == as_datetime(state_attr('calendar.work_s', 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==as_datetime(state_attr('calendar.work_s', 'start_time')).date()) == True) %}{% if state_attr('calendar.work_s','start_time') is defined %}{%- set date = as_timestamp(state_attr('calendar.work_s','start_time')) -%}{%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}{%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}{%- set month = month_list[m_ok-1] %}{% set start = as_timestamp(as_datetime(state_attr('calendar.work_s','start_time')))| timestamp_custom('%H:%M') %}{% set end = as_timestamp(as_datetime(state_attr('calendar.work_s','end_time')))| timestamp_custom('%H:%M') %}{% set start_day = as_timestamp(as_datetime(state_attr('calendar.work_s','start_time')))| timestamp_custom('%d') %}{% if start == end %} {{ start_day }} {{month }} весь день{% else %}c {{start}} по {{ end }}{% endif %}{% else %} Пусто{% endif %}{% else %} Пусто{% endif%}';
                    display: flex;
                    padding-top: 0.3em;
                    font-size: 10px;
                    color: var(--secondary-text-color);
                    font-weight: normal;
                  }
                mushroom-template-chip:nth-child(2)$: |
                  span:after {
                    content: '{% if is_state('calendar.work_m', 'unavailable') %} Неизвестно{% elif (((now().date() + timedelta(days=0)) ==as_datetime(state_attr('calendar.work_m', 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==as_datetime(state_attr('calendar.work_m', 'start_time')).date()) == True) %}{% if state_attr('calendar.work_m','start_time') is defined %}{%- set date = as_timestamp(state_attr('calendar.work_m','start_time')) -%}{%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}{%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}{%- set month = month_list[m_ok-1] %}{% set start = as_timestamp(as_datetime(state_attr('calendar.work_m','start_time')))| timestamp_custom('%H:%M') %}{% set end = as_timestamp(as_datetime(state_attr('calendar.work_m','end_time')))| timestamp_custom('%H:%M') %}{% set start_day = as_timestamp(as_datetime(state_attr('calendar.work_m','start_time')))| timestamp_custom('%d') %}{% if start == end %} {{ start_day }} {{month }} весь день{% else %}c {{start}} по {{ end }}{% endif %}{% else %} {% endif %}{% else %} {% endif%}';
                     display: flex;
                     padding-top: 0.3em;
                     font-size: 10px;
                     color:var(--secondary-text-color);
                     font-weight: normal; 
                mushroom-template-chip:nth-child(3)$: |
                  span:after {
                    content: '{% if is_state('calendar.1home', 'unavailable') %} Неизвестно{% elif (((now().date() + timedelta(days=0)) ==as_datetime(state_attr('calendar.1home', 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==as_datetime(state_attr('calendar.1home', 'start_time')).date()) == True) %}{% if state_attr('calendar.1home','start_time') is defined %}{%- set date = as_timestamp(state_attr('calendar.1home','start_time')) -%}{%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}{%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}{%- set month = month_list[m_ok-1] %}{% set start = as_timestamp(as_datetime(state_attr('calendar.1home','start_time')))| timestamp_custom('%H:%M') %}{% set end = as_timestamp(as_datetime(state_attr('calendar.1home','end_time')))| timestamp_custom('%H:%M') %}{% set start_day = as_timestamp(as_datetime(state_attr('calendar.1home','start_time')))| timestamp_custom('%d') %}{% if start == end %} {{ start_day }} {{month }} весь день{% else %}c {{start}} по {{ end }}{% endif %}{% else %} {% endif %}{% else %} {% endif%}';
                     display: flex;
                     padding-top: 0.3em;
                     font-size: 10px;
                     color:var(--secondary-text-color);
                     font-weight: normal; 
                mushroom-template-chip:nth-child(4)$: |
                  span:after {
                    content: '{% if is_state('calendar.melkaia', 'unavailable') %} Неизвестно{% elif (((now().date() + timedelta(days=0)) ==as_datetime(state_attr('calendar.melkaia', 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==as_datetime(state_attr('calendar.melkaia', 'start_time')).date()) == True) %}{% if state_attr('calendar.melkaia','start_time') is defined %}{%- set date = as_timestamp(state_attr('calendar.melkaia','start_time')) -%}{%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}{%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}{%- set month = month_list[m_ok-1] %}{% set start = as_timestamp(as_datetime(state_attr('calendar.melkaia','start_time')))| timestamp_custom('%H:%M') %}{% set end = as_timestamp(as_datetime(state_attr('calendar.melkaia','end_time')))| timestamp_custom('%H:%M') %}{% set start_day = as_timestamp(as_datetime(state_attr('calendar.melkaia','start_time')))| timestamp_custom('%d') %}{% if start == end %} {{ start_day }} {{month }} весь день{% else %}c {{start}} по {{ end }}{% endif %}{% else %}{% endif %}{% else %} {% endif%}';
                     display: flex;
                     padding-top: 0.3em;
                     font-size: 10px;
                     color:var(--secondary-text-color);
                     font-weight: normal; 
                mushroom-template-chip:nth-child(5)$: |
                  span:after {
                    content: '{% if is_state('calendar.5birthday', 'unavailable') %} Неизвестно{% elif (((now().date() + timedelta(days=0)) ==as_datetime(state_attr('calendar.5birthday', 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==as_datetime(state_attr('calendar.5birthday', 'start_time')).date()) == True) %}{% if state_attr('calendar.5birthday','start_time') is defined %}{%- set date = as_timestamp(state_attr('calendar.5birthday','start_time')) -%}{%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}{%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}{%- set month = month_list[m_ok-1] %}{% set start = as_timestamp(as_datetime(state_attr('calendar.5birthday','start_time')))| timestamp_custom('%H:%M') %}{% set end = as_timestamp(as_datetime(state_attr('calendar.5birthday','end_time')))| timestamp_custom('%H:%M') %}{% set start_day = as_timestamp(as_datetime(state_attr('calendar.5birthday','start_time')))| timestamp_custom('%d') %}{% if start == end %} {{ start_day }} {{month }} весь день{% else %}c {{start}} по {{ end }}{% endif %}{% else %} {% endif %}{% else %} {% endif%}';
                     display: flex;
                     padding-top: 0.3em;
                     font-size: 10px;
                     color:var(--secondary-text-color);
                     font-weight: normal; 
                .: |
                  ha-card {
                  margin: -10px -2px 0px;
                    --chip-height: 45px;
                    --chip-background: none;
                    --chip-spacing: 0px;
                    --chip-font-weight: bolder; 
                    --chip-font-size: 14px; 

                  }

                    ha-card > .chip-container {
                      flex-wrap: nowrap;
                      overflow-x: scroll;
                      overflow-y: hidden;
                      margin-top: 0px;            
                      padding-bottom: 8px;
                    }

                    ha-card > .chip-container > * {
                      flex-shrink: 0;
                    }

                    }
          - type: custom:mushroom-chips-card
            chips:
              - type: conditional
                conditions:
                  - entity: light.vsia_gostinaia
                    state_not: "122443"
                chip:
                  type: template
                  content: Камеры
                  double_tap_action:
                    action: none
                  tap_action:
                    action: none
                  hold_action:
                    action: none
            card_mod:
              style: |
                ha-card {
                  margin: -10px 0px 0px;
                  --chip-background: none;
                  --chip-border-width: 0;
                  --chip-box-shadow: none;
                  --chip-border-radius: 12px;
                  --chip-height: 40px;
                  --chip-padding: 14px;
                  --chip-spacing: -35px;
                  --chip-icon-size: 0.28em;
                  --chip-font-size: 0.7em;
                  height: 100%;
                  width: 100%;
                  top: 0px;
                  bottom: 0px;
                  left: 0px;
                }
        layout_options:
          grid_columns: full
      - type: custom:stack-in-card
        cards:
          - show_state: false
            show_name: false
            camera_view: auto
            aspect_ratio: 55%
            type: picture-entity
            camera_image: camera.gostinaia
            entity: camera.gostinaia
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_gost
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state('camera.gostinaia','unavailable')%}
                  mdi:alert-circle

                  {% else %} 

                  {% endif%}
                tap_action:
                  action: none
                double_tap_action:
                  action: none
                hold_action:
                  action: none
                icon_color: |-
                  {% if is_state('camera.gostinaia','unavailable')%} red
                  {% else %} 1
                  {% endif%}
                content: Гостиная
              - type: spacer
              - type: template
                icon: >-

                  {% if
                  is_state('binary_sensor.gostinaia_cell_motion_detection','on')%}
                  mdi:run-fast

                  {% elif
                  is_state('binary_sensor.gostinaia_cell_motion_detection','unavailable')%}
                  mdi:alert-circle

                  {% else %}

                  {% endif%}
                icon_color: >-

                  {% if
                  is_state('binary_sensor.gostinaia_cell_motion_detection','on')%}
                  1

                  {% elif
                  is_state('binary_sensor.gostinaia_cell_motion_detection','unavailable')%}
                  red

                  {% else %}

                  {% endif%} 
                card_mod:
                  style: |
                    ha-card {
                      --chip-background: none;
                    }
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.gostinaia_cell_motion_detection
            alignment: start
            card_mod:
              style: |
                ha-card {
                      margin-top: -5px;
                      margin-left: 5px;
                      margin-bottom: 3px;
                      --chip-font-size: 14px;
                      --chip-background: none;
                      --chip-height: 40px;
                      --chip-border-width: 0;
                      --chip-box-shadow: none;
                      --chip-border-radius: 12px;
                      --chip-spacing: 5px;
                      --chip-font-weight: normal;
                }
        card_mod:
          style: |
            ha-card:before {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
              content: "";
              position: absolute;
              height: 100%;
              width: 100%;

              background: url( '{{ state_attr( 'camera.gostinaia', "entity_picture" ) }}' ); center no-repeat;


              filter: blur(50px) saturate(200%);
              background-size: 100% 100%;
            }
            ha-card {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
            }
        layout_options:
          grid_columns: 2
          grid_rows: auto
      - type: custom:stack-in-card
        cards:
          - show_state: false
            show_name: false
            camera_view: auto
            type: picture-entity
            aspect_ratio: 55%
            camera_image: camera.kukhnia
            entity: camera.kukhnia
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_kuh
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state('camera.kukhnia','unavailable')%}
                  mdi:alert-circle

                  {% else %} 

                  {% endif%}
                tap_action:
                  action: none
                double_tap_action:
                  action: none
                hold_action:
                  action: none
                icon_color: |-
                  {% if is_state('camera.kukhnia','unavailable')%} red
                  {% else %} 1
                  {% endif%}
                content: Кухня
              - type: spacer
              - type: template
                icon: >-
                  {% if is_state('binary_sensor.motion_kuhnya_occupancy','on')%}
                  mdi:run-fast {% elif
                  is_state('binary_sensor.motion_kuhnya_occupancy','unavailable')%}
                  mdi:alert-circle {% else %}

                  {% endif%}
                icon_color: >-

                  {% if is_state('binary_sensor.motion_kuhnya_occupancy','on')%}
                  1

                  {% elif
                  is_state('binary_sensor.motion_kuhnya_occupancy','unavailable')%}
                  red

                  {% else %}

                  {% endif%} 
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.motion_kuhnya_occupancy
                card_mod:
                  style: |
                    ha-card {
                          --chip-background: none;

                    }
            alignment: start
            card_mod:
              style: |
                ha-card {
                      margin-top: -5px;
                      margin-left: 5px;
                      margin-bottom: 3px;
                      --chip-font-size: 14px;
                      --chip-background: none;
                      --chip-height: 40px;
                      --chip-border-width: 0;
                      --chip-box-shadow: none;
                      --chip-border-radius: 12px;
                      --chip-spacing: 5px;
                      --chip-font-weight: normal;
                }
        card_mod:
          style: |
            ha-card:before {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
              content: "";
              position: absolute;
              height: 100%;
              width: 100%;

              background: url( '{{ state_attr( 'camera.kukhnia', "entity_picture" ) }}' ); center no-repeat;


              filter: blur(50px) saturate(200%);
              background-size: 100% 100%;
            }
            ha-card {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
            }
        layout_options:
          grid_columns: 2
          grid_rows: auto
      - type: custom:stack-in-card
        cards:
          - show_state: false
            show_name: false
            camera_view: auto
            type: picture-entity
            camera_image: camera.balkon
            aspect_ratio: 55%
            entity: camera.balkon
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_balcon
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state('camera.balkon','unavailable')%}
                  mdi:alert-circle

                  {% else %} 

                  {% endif%}
                tap_action:
                  action: none
                double_tap_action:
                  action: none
                hold_action:
                  action: none
                icon_color: |-
                  {% if is_state('camera.balkon','unavailable')%} red
                  {% else %} 1
                  {% endif%}
                content: Балкон
              - type: spacer
              - type: conditional
                conditions:
                  - condition: state
                    entity: binary_sensor.balcon_cell_motion_detection
                    state_not: "off"
                chip:
                  type: template
                  icon: >-
                    {% if states(config.entity) in ['unknown', 'unavailable',
                    'none']  %} mdi:alert-circle {% elif
                    is_state('binary_sensor.balkon_person_detection', 'on')%}
                    mdi:run-fast {% elif is_state(config.entity,'on')%}
                    mdi:motion

                    {% else %}  {% endif %}
                  card_mod:
                    style: |
                      ha-card {
                            --chip-background: none;

                      }
                  icon_color: >-

                    {% if
                    is_state('binary_sensor.balkon_cell_motion_detection','unavailable')%}
                    red

                    {% else %} 1

                    {% endif%}
                  tap_action:
                    action: more-info
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  entity: binary_sensor.balkon_cell_motion_detection
            alignment: start
            card_mod:
              style: |
                ha-card {
                      margin-top: -5px;
                      margin-left: 5px;
                      margin-bottom: 3px;
                      --chip-font-size: 14px;
                      --chip-background: none;
                      --chip-height: 40px;
                      --chip-border-width: 0;
                      --chip-box-shadow: none;
                      --chip-border-radius: 12px;
                      --chip-spacing: 5px;
                      --chip-font-weight: normal;
                }
        card_mod:
          style: |
            ha-card:before {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
              content: "";
              position: absolute;
              height: 100%;
              width: 100%;

              background: url( '{{ state_attr( 'camera.balkon', "entity_picture" ) }}' ); center no-repeat;


              filter: blur(50px) saturate(200%);
              background-size: 100% 100%;
            }
            ha-card {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
            }
        layout_options:
          grid_columns: 2
          grid_rows: auto
      - type: custom:stack-in-card
        cards:
          - show_state: false
            show_name: false
            camera_view: auto
            type: picture-entity
            aspect_ratio: 55%
            camera_image: camera.prikhozhaia
            entity: camera.prikhozhaia
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_prih
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state('camera.prikhozhaia','unavailable')%}
                  mdi:alert-circle

                  {% else %} 

                  {% endif%}
                tap_action:
                  action: none
                double_tap_action:
                  action: none
                hold_action:
                  action: none
                icon_color: |-
                  {% if is_state('camera.prikhozhaia','unavailable')%} red
                  {% else %} 1
                  {% endif%}
                content: Прихожая
              - type: spacer
              - type: conditional
                conditions:
                  - condition: state
                    entity: binary_sensor.motion_enter_occupancy
                    state: "on"
                chip:
                  type: template
                  icon: mdi:run-fast
                  card_mod:
                    style: |
                      ha-card {
                            --chip-background: none;

                      }
            alignment: start
            card_mod:
              style: |
                ha-card {
                      margin-top: -5px;
                      margin-left: 5px;
                      margin-bottom: 3px;
                      --chip-font-size: 14px;
                      --chip-background: none;
                      --chip-height: 40px;
                      --chip-border-width: 0;
                      --chip-box-shadow: none;
                      --chip-border-radius: 12px;
                      --chip-spacing: 5px;
                      --chip-font-weight: normal;
                }
        card_mod:
          style: |
            ha-card:before {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
              content: "";
              position: absolute;
              height: 100%;
              width: 100%;
              background: url( '{{ state_attr( 'camera.prikhozhaia', "entity_picture" ) }}' ); center no-repeat;
              filter: blur(50px) saturate(200%);
              background-size: 100% 100%;
            }
            ha-card {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
            }
        layout_options:
          grid_columns: 2
          grid_rows: auto
    column_span: 6
    visibility:
      - condition: screen
        media_query: "(max-width: 1280px)"
  - type: grid
    cards:
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}} {% else %} mdi:account {%
              endif %}
            entity: person.stanislav
            picture: "{{state_attr(config.entity, 'entity_picture')}}"
            badge_icon: ""
            badge_color: "1"
            hold_action:
              action: none
            tap_action:
              action: more-info
            fill_container: true
            icon_color: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'home') %}
                     background: rgba(144, 190, 228,0.4);
                   {% elif is_state(config.entity,'В Ситилинке') %}
                     background: rgba(233, 92, 25,0.4);

                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Станислав
            secondary:  
            icon: ""
            entity: sensor.iphone_12_battery_level
            picture: ""
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            tap_action:
              action: none
            fill_container: true
            icon_color: ""
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.iphone_12_battery_level
                icon: "{{states[config.entity].attributes.icon}}"
                content: "{{states[config.entity].state}}%"
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: person.stanislav
                icon: mdi:map
                content: |2-
                        {% set x = states(config.entity) %}  {% set y =
                        state_attr('sensor.iphone_12_geocoded_location', 'Locality' )  %}  {% set
                        z = state_attr('sensor.iphone_12_geocoded_location',
                        'Name')|replace("улица ","")|replace("проспект ","")|replace("бульвар
                        ","") %}  {% if is_state(config.entity, 'home') %} Дома  {% elif
                        is_state(config.entity, 'В Ситилинке') %} На работе  {% elif
                        is_state(config.entity, 'Дом Мелкой') %} У Мелкой  {% elif
                        is_state(config.entity, 'not_home') %}   

                        {% if is_state_attr('sensor.iphone_12_geocoded_location', 'Locality',
                        'Волжский' ) %} {{z|string|truncate(20, True, '...', 0)|replace
                        ("'","")|replace ("(","")|replace(")","")}}   {% else %}
                        {{y|string|truncate(20, True, '...', 0)|replace ("'","")|replace
                        ("(","")|replace(")","")}}   {% endif %} {% else %}
                        {{states(config.entity)}}  {% endif %}
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.iphone_12_connection_type
                icon: "{{states[config.entity].attributes.icon}}"
                content: >+
                  {% set x = config.entity %}

                  {% set y = x|replace("connection_type","ssid") %}


                  {% if states[config.entity].state == 'Cellular' %} Yota

                  {% elif states[config.entity].state == 'Wi-Fi' %}
                  {{states[y].state}}

                  {% else %} {{states[config.entity].state}}

                  {% endif %}



            alignment: start
            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-height: 28px;
                  --chip-spacing: 0px;
                  margin-top: -31px;
                  margin-bottom: -27px; 
                  margin-left: 2px;
                  padding-bottom: 30px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: person.stanislav
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}} {% else %} mdi:account {%
              endif %}
            entity: person.melkaia
            picture: "{{state_attr(config.entity, 'entity_picture')}}"
            badge_icon: ""
            badge_color: "1"
            hold_action:
              action: none
            tap_action:
              action: more-info
            fill_container: true
            icon_color: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                   {% if is_state('person.melkaia','home') %}
                   
                    background: rgba(228, 200, 134,0.4);
                   {% elif states('person.melkaia') == states('input_text.rabota_melkaia')%} 
                    background: rgba(140, 5, 117, 0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Мелкая
            secondary:  
            icon: ""
            entity: sensor.iphone_valeriia_battery_level
            picture: ""
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            tap_action:
              action: none
            fill_container: true
            icon_color: ""
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.iphone_valeriia_battery_level
                icon: "{{states[config.entity].attributes.icon}}"
                content: "{{states[config.entity].state}}%"
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: person.melkaia
                icon: mdi:map
                content: |2-
                        {% set x = states(config.entity) %}    {% set y =
                        state_attr('sensor.iphone_valeriia_geocoded_location', 'Locality' ) %}  
                        {% set z = state_attr('sensor.iphone_valeriia_geocoded_location',
                        'Name')|replace("улица ","")|replace("проспект ","")|replace("бульвар
                        ","") %}  {% if states.person.melkaia.state ==
                        states.input_text.rabota_melkaia.state %} На работе   {% elif
                        is_state(config.entity, 'home') %} Дома   {% elif
                        is_state(config.entity,'В Кураже') %} В Кураже    {% elif
                        is_state(config.entity, 'Дом Мелкой') %} У Мамы    {% elif
                        is_state(config.entity, 'not_home') %}  
                           {% if is_state_attr('sensor.iphone_valeriia_geocoded_location', 'Locality', 'Волжский' ) %} 
                                 {{z|string|truncate(20, true, '...', 0)|replace ("'","")|replace ("(","")|replace(")","")}}  
                           {% else %} {{y|string|truncate(20, true, '...', 0)|replace ("'","")|replace ("(","")|replace(")","")}}  
                           {% endif %}
                        {% else %} {{states(config.entity)}}    {% endif %}
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.iphone_valeriia_connection_type
                icon: "{{states[config.entity].attributes.icon}}"
                content: >+
                  {% set x = config.entity %}

                  {% set y = x|replace("connection_type","ssid") %}


                  {% if states[config.entity].state == 'Cellular' %} Tele2

                  {% elif states[config.entity].state == 'Wi-Fi' %}
                  {{states[y].state}}

                  {% else %} {{states[config.entity].state}}

                  {% endif %}



            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-height: 28px;
                  --chip-spacing: 0px;
                  margin-top: -31px;
                  margin-bottom: -27px;
                  margin-left: 2px;
                  padding-bottom: 30px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: person.melkaia
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:account

              {% endif %}
            entity: person.tioma
            picture: "{{state_attr(config.entity, 'entity_picture')}}"
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            tap_action:
              action: more-info
            fill_container: true
            icon_color: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-color1: none !important;
                    --icon-symbol1-size:30px;
                  }
                .: |
                  ha-card { 
                    background-color: rgba(255,255,255,0) }};
                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Пользователь

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'home') %} Дома • Wi-Fi
              {% else %} Не дома
              {% endif %}
            icon: ""
            entity: person.tioma
            picture: ""
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            tap_action:
              action: more-info
            fill_container: true
            icon_color: ""
            double_tap_action:
              action: none
            card_mod:
              style: >
                ha-card { 
                  background-color: rgba(255,255,255,0) }};
                --primary-text-color: {{ '#141414' if is_state('person.tioma',
                'home') else ' ' }};

                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: |-
                  {% if is_state(config.entity, 'home') %} mdi:wifi
                  {% else %} mdi:wifi-off
                  {% endif %}
                icon_color: |-
                  {% if is_state(config.entity, 'home') %} blue
                  {% else %} red
                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: person.tioma
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        card_mod:
          style: >
            ha-card { 
              background-color: {{ 'white' if is_state('person.tioma', 'home') else ' ' }};
              layout: 'left';
            --primary-text-color: {{ '#141414' if is_state('person.tioma',
            'home') else ' ' }};

            }
        layout_options:
          grid_columns: 1
          grid_rows: auto
        visibility:
          - condition: state
            entity: person.tioma
            state: home
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:account

              {% endif %}
            entity: person.iulka
            picture: "{{state_attr(config.entity, 'entity_picture')}}"
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            tap_action:
              action: more-info
            fill_container: true
            icon_color: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-color1: none !important;
                    --icon-symbol1-size:30px;
                  }
                .: |
                  ha-card { 
                    background-color: rgba(255,255,255,0) }};
                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Пользователь

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'home') %} Дома • Wi-Fi
              {% else %} Не дома
              {% endif %}
            icon: ""
            entity: person.iulka
            picture: ""
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            tap_action:
              action: more-info
            fill_container: true
            icon_color: ""
            double_tap_action:
              action: none
            card_mod:
              style: >
                ha-card { 
                  background-color: rgba(255,255,255,0) }};
                --primary-text-color: {{ '#141414' if is_state('person.iulka',
                'home') else ' ' }};

                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: |-
                  {% if is_state(config.entity, 'home') %} mdi:wifi
                  {% else %} mdi:wifi-off
                  {% endif %}
                icon_color: |-
                  {% if is_state(config.entity, 'home') %} blue
                  {% else %} red
                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: person.iulka
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        card_mod:
          style: >
            ha-card { 
              background-color: {{ 'white' if is_state('person.iulka', 'home') else ' ' }};
              layout: 'left';
            --primary-text-color: {{ '#141414' if is_state('person.iulka',
            'home') else ' ' }};

            }
        layout_options:
          grid_columns: 1
          grid_rows: auto
        visibility:
          - condition: state
            entity: person.iulka
            state: home
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:account

              {% endif %}
            entity: person.babulia
            picture: "{{state_attr(config.entity, 'entity_picture')}}"
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            tap_action:
              action: more-info
            fill_container: true
            icon_color: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-color1: none !important;
                    --icon-symbol1-size:30px;
                  }
                .: |
                  ha-card { 
                    background-color: rgba(255,255,255,0) }};
                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Пользователь

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'home') %} Дома • BT
              {% else %} Не дома
              {% endif %}
            icon: ""
            entity: person.babulia
            picture: ""
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            tap_action:
              action: more-info
            fill_container: true
            icon_color: ""
            double_tap_action:
              action: none
            card_mod:
              style: >
                ha-card { 
                  background-color: rgba(255,255,255,0) }};
                --primary-text-color: {{ '#141414' if is_state('person.iulka',
                'home') else ' ' }};

                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: |-
                  {% if is_state(config.entity, 'home') %} mdi:wifi
                  {% else %} mdi:wifi-off
                  {% endif %}
                icon_color: |-
                  {% if is_state(config.entity, 'home') %} blue
                  {% else %} red
                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: person.babulia
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        card_mod:
          style: >
            ha-card { 
              background-color: {{ 'white' if is_state('person.iulka', 'home') else ' ' }};
              layout: 'left';
            --primary-text-color: {{ '#141414' if is_state('person.iulka',
            'home') else ' ' }};

            }
        visibility:
          - condition: state
            entity: person.babulia
            state: home
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:vacuum
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: sensor.vacuum_status
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'Отключен') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Пылесос
            secondary: "{{states(config.entity)}}"
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: sensor.vacuum_status
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >+
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% elif states('sensor.vacuum_status') in ['Недоступно',
                  'unavailable', 'none']  %} mdi:alert-circle

                  {% elif states('sensor.vacuum_contact_battery')|float(0) < 20
                  %} fas:battery-quarter

                  {% else %} 


                  {% if states(config.entity)|float(0) > 10 %}
                  mdi:lightning-bolt

                  {% else %} 

                  {% endif%}


                  {% endif %}

                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% elif states('sensor.vacuum_status') in ['Недоступно',
                  'unavailable', 'none'] %} red

                  {% elif states('sensor.vacuum_contact_battery')|float(0) < 20
                  %} red

                  {% else %} 


                  {% if states(config.entity)|float(0) > 10 %} orange

                  {% else %} 

                  {% endif%}


                  {% endif %}
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.vacuum_power
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:home-thermometer
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.ble_temperature_a4c1387e6730
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 25 %}  
                             {% set max = 35 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(120, 120, 180, 0.5) {{z}}%, 
                          rgba(120, 120, 180, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Климат
            secondary:  
            icon: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.ble_temperature_a4c1387e6730
            icon_color: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% elif is_state(config.entity,'unknown')%} mdi:alert-circle

                  {% elif states('sensor.ble_battery_a4c1387e6730')|int <= 20 %}
                  fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c1387e6730
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c1387e6730
                icon: mdi:thermometer
                content: |2-
                        {% if is_state(config.entity, 'unavailable') %}
                        Неизвестно {% else %} {{states(config.entity)|
                        float(0) | round(1)| replace(".",",")}}°  {% endif %}
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_humidity_a4c1387e6730
                icon: mdi:water
                content: |2-
                        {% if is_state(config.entity, 'unavailable') %}
                        Неизвестно {% else %} {{states(config.entity)|
                        float(0) | round(1)| replace(".",",")}}%  {% endif %}
                icon_color: ""
            alignment: start
            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-height: 28px;
                  --chip-spacing: 0px;
                  margin-top: -31px;
                  margin-left: 0px;
                  margin-bottom: -27px; 
                  padding-bottom: 30px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.temp_otoplenie_temperature
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 35 %}  
                             {% set max = 55 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(255, 50, 50, 0.5) {{z}}%, 
                          rgba(255, 50, 50, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Отопление
            secondary: "{{states(config.entity)| float(0)| replace (\".\",\",\") }}°"
            icon: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.temp_otoplenie_temperature
            icon_color: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >+
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% elif state_attr(config.entity,'battery') <= 20%}
                  fas:battery-quarter

                  {% else %} 

                  {% endif %}

                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.temp_otoplenie_temperature
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: sensor.lux_gost_illuminance
            tap_action:
              action: none
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = 500 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(120, 120, 120, 0.5) {{z}}%, 
                          rgba(120, 120, 120, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Яркость
            secondary: |-
              {% if is_state(config.entity, 'unavailable')%} Недоступен
              {% else %} {{states(config.entity)}} Люкс
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: sensor.lux_gost_illuminance
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_illuminance","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.lux_gost_illuminance
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:weight-kilogram
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            hold_action:
              action: none
            entity: sensor.ves_stanislav
            tap_action:
              action: none
            picture: "{{state_attr('person.stanislav', 'entity_picture')}}"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 60 %}  
                             {% set max = 70 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(144, 190, 228, 0.5) {{z}}%, 
                          rgba(159, 198, 232, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Станислав
            secondary: "{{states(config.entity)| replace (\".\",\",\") }} Кг"
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: sensor.ves_stanislav
            picture: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:weight-kilogram
                icon_color: 150,150,150,0.2
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:weight-kilogram
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: sensor.ves_melkaya
            tap_action:
              action: none
            picture: "{{state_attr('person.melkaia', 'entity_picture')}}"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 40 %}  
                             {% set max = 50 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(228, 200, 134, 0.5) {{z}}%, 
                          rgba(228, 200, 134, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Мелкая
            secondary: "{{states(config.entity)| replace (\".\",\",\") }} Кг"
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: sensor.ves_melkaya
            picture: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:weight-kilogram
                icon_color: 150,150,150,0.5
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:weight-kilogram
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            hold_action:
              action: none
            entity: sensor.ves_tim
            tap_action:
              action: none
            picture: "{{state_attr('person.tioma', 'entity_picture')}}"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 75 %}  
                             {% set max = 85 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(200, 233, 250, 0.5) {{z}}%, 
                          rgba(200, 233, 250, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Тёма
            secondary: "{{states(config.entity)| replace (\".\",\",\") }} Кг"
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: sensor.ves_tim
            picture: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:weight-kilogram
                icon_color: 150,150,150,0.5
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:run-fast
              {% else %} mdi:run
              {% endif %}
            entity: binary_sensor.gostinaia_cell_motion_detection
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: "1"
            picture: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Движение
            secondary: >-
              {% if states(config.entity) in ['unknown', 'unavailable', 'none'] 
              %} Недоступно

              {% else %}

                 {% set time = as_timestamp(now()) - as_timestamp(states.binary_sensor.gostinaia_cell_motion_detection.last_changed) %}
                 {% set days = (time // 86400) | int(0)%}
                 {% set hours = (time % 86400) // 3600 | int(0)%}
                 {% set minutes = ((time % 86400) % 3600) //60 | int(0)%}
                 {% set seconds = ((((time % 86400) % 3600) % 60)) | int(0) %}

                 {% if days > 370%} Более года назад
                 {% elif days > 185%} Более полугода назад
                 {% elif days > 95%} Более трёх месяцев назад
                 {% elif days > 62%} Более двух месяцев назад
                 {% elif days > 31%} Более месяца назад
                 {% elif days > 0 %} {{days| round()|format(morph='день', as_text=false) }} назад
                 {% elif days == 0 %}
                   {% if hours > 0 %} {{hours| round()|format(morph='час', as_text=false) }} назад
                   {% elif hours == 0 %}
                     {% if minutes > 0 %} {{minutes | round()|format(morph='минуту', as_text=false) }} назад
                     {% elif minutes == 0 %}
                       {% if seconds == 0 %} Только что
                       {% elif seconds > 0 %} {{seconds| round()|format(morph='секунду', as_text=false) }} назад
                       {% else %} Неизвестно
                       {% endif %}
                     {% endif %}
                   {% else %} 
                   {% endif %}
                 {% else %} 
                 {% endif %}
              {% endif %}
            icon: ""
            entity: binary_sensor.gostinaia_cell_motion_detection
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.gostinaia_cell_motion_detection
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:vibrate
              {% else %} mdi:vibrate-off
              {% endif %}
            entity: binary_sensor.vibro_vibration
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: "1"
            picture: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Вибрация
            secondary: |-
              {% if is_state(config.entity, 'unavailable')%} Недоступно
              {% else %}

                 {% set time = as_timestamp(now()) - as_timestamp(states.binary_sensor.vibro_vibration.last_changed) %}
                 {% set days = (time // 86400) | int(0)%}
                 {% set hours = (time % 86400) // 3600 | int(0)%}
                 {% set minutes = ((time % 86400) % 3600) //60 | int(0)%}
                 {% set seconds = ((((time % 86400) % 3600) % 60)) | int(0) %}

                 {% if days > 370%} Более года назад
                 {% elif days > 185%} Более полугода назад
                 {% elif days > 95%} Более трёх месяцев назад
                 {% elif days > 62%} Более двух месяцев назад
                 {% elif days > 31%} Более месяца назад
                 {% elif days > 0 %} {{days| round()|format(morph='день', as_text=false) }} назад
                 {% elif days == 0 %}
                   {% if hours > 0 %} {{hours| round()|format(morph='час', as_text=false) }} назад
                   {% elif hours == 0 %}
                     {% if minutes > 0 %} {{minutes | round()|format(morph='минуту', as_text=false) }} назад
                     {% elif minutes == 0 %}
                       {% if seconds == 0 %} Только что
                       {% elif seconds > 0 %} {{seconds| round()|format(morph='секунду', as_text=false) }} назад
                       {% else %} Неизвестно
                       {% endif %}
                     {% endif %}
                   {% else %} 
                   {% endif %}
                 {% else %} 
                 {% endif %}
              {% endif %}
            icon: ""
            entity: binary_sensor.vibro_vibration
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_vibration","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.vibro_vibration
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
    column_span: 6
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: light.vsia_gostinaia
                state_not: "122443"
            chip:
              type: template
              content: Гостиная
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
        card_mod:
          style: |
            ha-card {
              margin: 12px 0px 0px;
              --chip-background: none;
              --chip-border-width: 0;
              --chip-box-shadow: none;
              --chip-border-radius: 12px;
              --chip-height: 40px;
              --chip-padding: 14px;
              --chip-spacing: -35px;
              --chip-icon-size: 0.28em;
              --chip-font-size: 0.7em;
            }
        grid_options:
          columns: full
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:lightbulb

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.ceilc_7cc294e765ce
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba({{state_attr(config.entity,'rgb_color')|replace ("(","")|replace (")","")}},0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% if x > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.ceilc_7cc294e765ce
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.ceilc_7cc294e765ce
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:lightbulb

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.yeelight_ceilc_0x1fcd27ce_nightlight
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                  {% if is_state(config.entity,'on')%}

                    background: #a67c1b40;
                  {% else %} {% endif %}


                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% if x > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.yeelight_ceilc_0x1fcd27ce_nightlight
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.yeelight_ceilc_0x1fcd27ce_nightlight
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:lightbulb

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            entity: light.nisha
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba({{state_attr('light.nisha','rgb_color')|replace ("(","")|replace (")","")}},0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% set y = (expand(config.entity) | map(attribute='entity_id') | list | count)%}
               {% if y > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            entity: light.nisha
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.nisha
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: conditional
                conditions:
                  - condition: state
                    entity: light.nisha
                    state: "on"
                chip:
                  type: template
                  tap_action:
                    action: perform-action
                    perform_action: light.turn_on
                    target:
                      entity_id: light.nisha
                    data:
                      brightness_pct: 100
                      kelvin: 4081
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  icon: >+
                    {% if state_attr(config.entity, 'brightness')|float(0) ==
                    255 

                    and 


                    state_attr(config.entity, 'color_temp_kelvin')|float(0) ==
                    4081 

                    %} 


                    {% else %}

                    mdi:refresh-circle

                    {% endif %}

                  icon_color: "1"
                  entity: light.nisha
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:lightbulb

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.aktsent
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba({{state_attr(config.entity,'rgb_color')|replace ("(","")|replace (")","")}},0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% set y = (expand(config.entity) | map(attribute='entity_id') | list | count)%}
               {% if y > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.aktsent
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.aktsent
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:lightbulb

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.torsher_mono
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba({{state_attr(config.entity,'rgb_color')|replace ("(","")|replace (")","")}},0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% set y = (expand(config.entity) | map(attribute='entity_id') | list | count)%}
               {% if y > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.torsher_mono
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.torsher_mono
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:lightbulb

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.torsher_2
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on')%}
                        background: linear-gradient(180deg, rgba({{state_attr('light.yeelight_colorb_0x1b11995d','rgb_color')|replace ("(","")|replace (")","")}},0.4) 30%, rgba({{state_attr('light.yeelight_colorb_0xed432a3','rgb_color')|replace ("(","")|replace (")","")}},0.4) 80%);
                   {% else %}
                   {% endif %}


                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% set y = (expand(config.entity) | map(attribute='entity_id') | list | count)%}
               {% if y > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            entity: light.torsher_2
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/2-light
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.torsher_2
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            entity: switch.svechi
            icon_color: "1"
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            fill_container: true
            tap_action:
              action: toggle
            hold_action:
              action: none
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Свечи
            secondary: |
              {% if is_state(config.entity, 'on') %} Включено
              {% elif is_state(config.entity, 'off') %} Выключено
              {% elif is_state(config.entity, 'unavailable') %} Недоступно
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            entity: switch.svechi
            icon_color: ""
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            fill_container: true
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: more-info
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: switch.svechi
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            entity: switch.girlyand_tv
            icon_color: "1"
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            fill_container: true
            tap_action:
              action: toggle
            hold_action:
              action: more-info
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Гирлянда
            secondary: |
              {% if is_state(config.entity, 'on') %} Включено
              {% elif is_state(config.entity, 'off') %} Выключено
              {% elif is_state(config.entity, 'unavailable') %} Недоступно
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            entity: switch.girlyand_tv
            icon_color: ""
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            fill_container: true
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: more-info
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: switch.girlyand_tv
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
        visibility:
          - condition: state
            entity: input_boolean.kanun_novogo_goda
            state: "on"
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            entity: switch.girlyand_window
            icon_color: "1"
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            fill_container: true
            tap_action:
              action: toggle
            hold_action:
              action: more-info
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Штора (Окно)
            secondary: |-
              {% if is_state(config.entity, 'on') %} Включено
              {% elif is_state(config.entity, 'off') %} Выключено
              {% elif is_state(config.entity, 'unavailable') %} Недоступно
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            entity: switch.girlyand_window
            icon_color: ""
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            fill_container: true
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: more-info
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: switch.girlyand_window
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            entity: switch.girland_stol
            icon_color: "1"
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            fill_container: true
            tap_action:
              action: toggle
            hold_action:
              action: more-info
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Штора (Стол)
            secondary: |-
              {% if is_state(config.entity, 'on') %} Включено
              {% elif is_state(config.entity, 'off') %} Выключено
              {% elif is_state(config.entity, 'unavailable') %} Недоступно
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            entity: switch.girland_stol
            icon_color: ""
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            fill_container: true
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: more-info
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: switch.girland_stol
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
        visibility:
          - condition: state
            entity: input_boolean.kanun_novogo_goda
            state: "on"
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            entity: climate.ac_fan
            icon: |-
              {% if is_state(config.entity, 'cool') %} mdi:snowflake
              {% elif is_state(config.entity, 'heat') %} mdi:heat-wave
              {% elif is_state(config.entity, 'auto') %} mdi:fan-auto
              {% elif is_state(config.entity, 'dry') %} mdi:water-opacity
              {% else %}{{state_attr(config.entity, 'icon')}}
              {% endif %}
            double_tap_action:
              action: more-info
            tap_action:
              action: perform-action
              perform_action: switch.toggle
              target:
                entity_id: switch.ac_switch
            fill_container: true
            primary_info: none
            secondary_info: none
            icon_color: "1"
            badge_icon: ""
            badge_color: ""
            picture: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% if is_state('climate.ac_fan', 'off') %} 
                             {% set color = '120, 120, 120' %}
                             {% elif is_state('climate.ac_fan', 'cool') %} 
                             {% set color = '0, 102, 255' %}
                             {% elif is_state('climate.ac_fan', 'heat') %} 
                             {% set color = '255, 0, 0' %}
                             {% elif is_state('climate.ac_fan', 'dry') %} 
                             {% set color = '255, 183, 0' %}
                             {% elif is_state('climate.ac_fan', 'auto') %} 
                             {% set color = '0, 92, 145' %}
                             {% else %} {% set color = '120, 120, 120' %}
                             {% endif %}
                             
                             {% if states('sensor.season') == 'winter' %} 
                             {% set min = states('input_number.kond_zima_min')|int(0) %}  
                             {% set max = states('input_number.kond_zima_maks')|int(0) %}
                             {% else %}
                             {% set min = states('input_number.kond_leto_min')|int(0) %}  
                             {% set max = states('input_number.kond_leto_maks')|int(0) %}
                             {% endif %}

                             {% set x = states('sensor.ble_temperature_a4c1387e6730')|float(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba({{color}}, 0.5) {{z}}%, 
                          rgba({{color}}, 0.1) 0.1%) !important;

                  }  
          - type: custom:mushroom-template-card
            entity: climate.ac_fan
            icon: ""
            double_tap_action:
              action: more-info
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/ac-ios
            fill_container: true
            icon_type: none
            primary: Кондиционер
            secondary: >-
              {% if is_state(config.entity, 'off') %} Выключено

              {% elif is_state(config.entity, 'unavailable') %} Неизвестно

              {% elif is_state(config.entity, 'unknown') %} Неизвестно

              {% elif states(config.entity) != 'off' %} Вкл ›
              {{state_attr(config.entity, 'temperature')|round()}}°

              {% endif %} 
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
            icon_color: ""
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% if is_state(config.entity, 'off') %} 

                  {% else %}

                  {% if is_state_attr(config.entity, 'fan_mode', 'low')%}
                  mdi:fan-speed-1

                  {% elif is_state_attr(config.entity, 'fan_mode', 'mid')%}
                  mdi:fan-speed-2

                  {% elif is_state_attr(config.entity, 'fan_mode', 'high')%}
                  mdi:fan-speed-3

                  {% elif is_state_attr(config.entity, 'fan_mode', 'auto')%}
                  mdi:fan-auto

                  {% else %}

                  {% endif %}

                  {% endif %}

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 150,150,150,0.2

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: climate.ac_fan
                content: ""
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
                  --chip-font-weight: mormal; 
                  --chip-font-size: 10px; 
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: remote.universal_remote
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.open_ac_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: bha:apple-tv
            entity: media_player.gostinaia
            badge_color: ""
            badge_icon: ""
            picture: >-
              {% if is_state_attr('media_player.gostinaia', 'app_id',
              'com.apple.TVMusic')%} {{state_attr('media_player.gostinaia',
              'entity_picture')}}

              {% elif is_state_attr('media_player.gostinaia', 'app_id',
              'com.apple.TVWatchList')%} {{state_attr('media_player.gostinaia',
              'entity_picture')}}

              {% else %} 

              {% endif %}
            icon_color: "1"
            fill_container: true
            tap_action:
              action: perform-action
              perform_action: media_player.media_play_pause
              target:
                entity_id: media_player.gostinaia
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba(120,120,120,0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if is_state(config.entity, 'playing')%} 
                {% if is_state_attr(config.entity, 'app_id', 'ru.kinopoisk')%} Кинопоиск
                {% elif is_state_attr(config.entity, 'app_id', 'com.google.ios.youtube')%} YouTube
                {% elif is_state_attr(config.entity, 'app_id', 'com.apple.TVAirPlay')%} AirPlay
                {% elif is_state_attr(config.entity, 'app_id', 'com.apple.TVWatchList')%} AppleTV+
                {% elif is_state_attr(config.entity, 'app_id', 'com.apple.TVMusic')%} Apple Music
                {% elif is_state_attr(config.entity, 'app_id', 'org.videolan.vlc-ios')%} VLC
                {% elif is_state_attr(config.entity, 'app_id', 'ru.ivi')%} Иви
                {% else %} Apple TV
                {% endif %}
                {% else %} Apple TV
              {% endif %}
            secondary: |
              {% if is_state(config.entity, 'playing')%} 
                {% if is_state_attr(config.entity, 'app_id', 'com.apple.TVAirPlay') and state_attr('media_player.gostinaia', 'media_title') == '' %} 
                {{state_attr(config.entity, 'app_name')}}
                {% else %} 
                         {% if state_attr(config.entity, 'media_title') == '' %}Без названия
                         {% else %} {{state_attr(config.entity, 'media_title')}}
                         {% endif %}
                {% endif %}
              {% elif is_state(config.entity, 'standby')%} Сон
              {% elif is_state(config.entity, 'paused')%} Пауза
              {% else %} Бездействие
              {% endif %}
            icon: ""
            layout: horizontal
            entity: media_player.gostinaia
            badge_color: ""
            badge_icon: ""
            picture: ""
            icon_color: ""
            fill_container: true
            multiline_secondary: false
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/appletv_ios
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.gostinaia
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: conditional
            conditions:
              - condition: state
                entity: media_player.gostinaia
                state_not: unavailable
              - condition: state
                entity: sensor.appletvapp
                state: com.apple.TVAirPlay
            card:
              entity: media_player.gostinaia
              hide:
                icon: true
                name: true
                runtime: true
                source: true
                power: true
                state_label: true
                volume: true
                info: true
                progress: false
                controls: true
              more_info: false
              type: custom:mini-media-player
              toggle_power: true
              group: true
              volume_stateless: false
              card_mod:
                style:
                  mmp-progress$: |
                    paper-progress {
                      {{ '--paper-progress-container-color: rgba(var(--rgb-indigo-color), 1) !important;' if is_state('media_player.yandex_station_m00en2100jayck', 'playing') }}
                    }
                  .: |
                    ha-card {
                      margin: -4.5px 0px 0px;
                      height: var(--mmp-progress-height);
                      --mmp-accent-color: #505050;
                      --ha-card-border-width: 0;
                    }
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: yandex:station-mini-2
            entity: media_player.yandex_station_m00en2100jayck
            picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
            badge_icon: ""
            badge_color: ""
            icon_color: "1"
            tap_action:
              action: perform-action
              perform_action: media_player.media_play_pause
              data: {}
              target:
                entity_id: media_player.yandex_station_m00en2100jayck
            double_tap_action:
              action: none
            fill_container: true
            layout: horizontal
            hold_action:
              action: none
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-color1: none !important;
                    --icon-symbol1-size:30px;
                  }
                .: |
                  ha-card { 
                    background-color: rgba(255,255,255,0) }};
                  }  
          - type: custom:mushroom-template-card
            primary: |+
              {% if is_state(config.entity, 'playing') %} 
                {% if state_attr(config.entity,'media_title') is none %} Неизвестно
                {% else%} {{state_attr(config.entity, 'media_title')}}
                {% endif %}
              {% else %} Станция Мини
              {% endif %}




            secondary: >-
              {% set x =
              state_attr('media_player.yandex_station_m00en2100jayck','media_position')|float(0)|round(0)
              %}

              {% set y =
              state_attr('media_player.yandex_station_beige','media_position')|float(0)|round(0)
              %}

              {% set z =
              state_attr('media_player.yandex_station_purple','media_position')|float(0)|round(0)
              %}


              {% if is_state(config.entity, 'playing') %}
                 {% if is_state('binary_sensor.multirum_sostoianie','on')%} 
                   {% set time = ([x, y, z]|max) %} 
                   {{as_timestamp(as_datetime(time))| timestamp_custom('%-M:%S') }} • Везде
                 {% else %} {{as_timestamp(as_datetime(x))| timestamp_custom('%-M:%S') }}
                 {% endif %}
              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Бездействие

              {% endif %}
            icon: ""
            entity: media_player.yandex_station_m00en2100jayck
            picture: ""
            badge_icon: ""
            badge_color: 17,17,17
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/mini
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state(config.entity, 'unavailable') %}
                  mdi:alert-circle

                  {% else %} 
                    {% if is_state_attr(config.entity, 'alice_state', 'LISTENING') %} mdi:ear-hearing 
                    {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
                    {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
                    {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
                    {% else %} mdi:sleep
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_m00en2100jayck
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
        visibility:
          - condition: state
            entity: media_player.yandex_station_m00en2100jayck
            state_not: playing
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: yandex:station-mini-2
            entity: media_player.yandex_station_m00en2100jayck
            picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
            badge_icon: ""
            badge_color: ""
            icon_color: white
            tap_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'playing')%}
                        {% if state_attr(config.entity,'media_duration') != None %}
                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = state_attr(config.entity,'media_duration')|int(0) %}
                             {% set x = state_attr(config.entity,'media_position')|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(120, 120, 120, 1) {{z}}%, 
                          rgba(120, 120, 120, 0.5) 0.1%) !important;
                        {% else %} 
                         background: rgb(120,120,120)   
                        {% endif %}
                   {% else %}
                   {% endif %}


                  }  
          - type: custom:mushroom-template-card
            primary: |+
              {% if is_state(config.entity, 'playing') %} 
                {% if state_attr(config.entity,'media_title') is none %} Неизвестно
                {% else%} {{state_attr(config.entity, 'media_title')}}
                {% endif %}
              {% else %} Станция Мини
              {% endif %}




            secondary: >-
              {% set g =
              state_attr('media_player.yandex_station_m00en2100jayck','media_position')|float(0)|round(0)
              %}

              {% set b =
              state_attr('media_player.yandex_station_beige','media_position')|float(0)|round(0)
              %}

              {% set p =
              state_attr('media_player.yandex_station_purple','media_position')|float(0)|round(0)
              %}

              {% set c =
              state_attr('media_player.yandex_station_cyan','media_position')|float(0)|round(0)
              %}


              {% if is_state(config.entity, 'playing') %}
                 {% if is_state('binary_sensor.multirum_sostoianie','on')%} 
                   {% set time = ([g, b, p, c]|max) %} 
                   {{as_timestamp(as_datetime(time))| timestamp_custom('%-M:%S') }} • Везде
                 {% else %} {{as_timestamp(as_datetime(g))| timestamp_custom('%-M:%S') }}
                 {% endif %}
              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Бездействие

              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            entity: media_player.yandex_station_m00en2100jayck
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state(config.entity, 'unavailable') %}
                  mdi:alert-circle

                  {% else %} 
                    {% if is_state_attr(config.entity, 'alice_state', 'LISTENING') %} mdi:ear-hearing 
                    {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
                    {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
                    {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
                    {% else %} mdi:sleep
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_m00en2100jayck
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  left: 45px !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: mdi:skip-previous
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_previous_track
                  target:
                    entity_id:
                      - media_player.yandex_station_m00en2100jayck
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 75px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: |-
                  {% if is_state(config.entity, 'paused')%}mdi:play
                  {% elif is_state(config.entity, 'playing')%}mdi:pause
                  {% else %} mdi:lock
                  {% endif %}
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    entity_id: media_player.yandex_station_m00en2100jayck
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_m00en2100jayck
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 40px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: mdi:skip-next
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_next_track
                  target:
                    entity_id: media_player.yandex_station_m00en2100jayck
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 5px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 6
          rows: auto
        visibility:
          - condition: state
            entity: media_player.yandex_station_m00en2100jayck
            state: playing
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:soundbar
            picture: ""
            badge_icon: ""
            badge_color: ""
            icon_color: "1"
            tap_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            hold_action:
              action: none
            layout: horizontal
            entity: media_player.samsung
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Саундбар
            secondary: |-
              {% if is_state(config.entity, 'on') %} Включено
              {% elif is_state(config.entity, 'off') %} Выключено
              {% elif is_state(config.entity, 'unavailable') %} Недоступно
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            picture: ""
            badge_icon: ""
            badge_color: ""
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/soundbar
            entity: media_player.samsung
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:power
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: remote.send_command
                  target:
                    entity_id: remote.universal_remote
                  data:
                    num_repeats: 1
                    delay_secs: 0.4
                    hold_secs: 0
                    device: b550
                    command: power
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            picture: ""
            badge_icon: ""
            badge_color: ""
            icon_color: "1"
            tap_action:
              action: toggle
            double_tap_action:
              action: none
            fill_container: true
            hold_action:
              action: navigate
              navigation_path: /dashboard-iphone/edidier-ir
            entity: input_boolean.akustika
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: >-
              {% if is_state(config.entity, 'on') %} Вкл •
              {{states('input_select.r1280db_source')}}

              {% elif is_state(config.entity, 'off') %} Выключено

              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Неизвестно

              {% endif %}
            icon: ""
            picture: ""
            badge_icon: ""
            badge_color: ""
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            entity: input_boolean.akustika
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/edidier-ir
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% if is_state('input_boolean.akustika', 'on') %}
                   {% if is_state('input_select.r1280db_source', 'M-Audio') %} mdi:audio-video
                   {% elif is_state('input_select.r1280db_source', 'PC') %} mdi:desktop-tower-monitor
                   {% elif is_state('input_select.r1280db_source', 'Bluetooth') %} mdi:bluetooth
                   {% endif %}
                  {% else %}

                  {% endif %}

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% if is_state('input_select.r1280db_source', 'M-Audio') %} 1

                  {% elif is_state('input_select.r1280db_source', 'PC') %} blue

                  {% elif is_state('input_select.r1280db_source', 'Bluetooth')
                  %} #0008ff

                  {% endif %}

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: remote.universal_remote
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - show_state: false
            show_name: false
            camera_view: auto
            aspect_ratio: 55%
            type: picture-entity
            camera_image: camera.gostinaia
            entity: camera.gostinaia
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_gost
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card {
                  height: 112px !important;
                  bottom: 0px !important;
                  left: 0px !important;
                  background-color: rgba(0,0,0,0.5) !important;
          - type: custom:mushroom-template-card
            primary: Гостиная
            secondary: Камера
            icon: |-
              {% if is_state('switch.gostinaia_privacy','on')%} mdi:eye-off
              {% else %}
              {% endif %}
            entity: camera.gostinaia
            picture: ""
            icon_color: |-
              {% if is_state('switch.gostinaia_privacy','on')%} red
              {% else %}
              {% endif %}
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_gost
            hold_action:
              action: none
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  width:100%;
                  bottom: 0px !important;
                  left: 0px !important;
                  background-color: rgba(var(--rgb-card-background-color), 0.5);
                  }
                ha-card:hover { 
                  background-color: rgba(var(--rgb-card-background-color), 0.7);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: |2-
                   {% if states(config.entity) in ['unknown', 'unavailable', 'none']  %} mdi:alert-circle
                   {% elif is_state(config.entity,'on')%} mdi:run-fast
                   {% else %} 
                   {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red 

                  {% elif is_state(config.entity,'on')%} 1 

                  {% else %}  

                  {% endif %}
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.gostinaia_cell_motion_detection
            alignment: start
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  bottom: 8px !important;
                  right: 0px; !important;
                  --chip-background:  none !important;
                  --chip-height: 40px !important;
        grid_options:
          columns: 6
          rows: auto
        visibility:
          - condition: screen
            media_query: "(min-width: 1280px)"
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: more-info
            entity: automation.konditsioner_vkl_vykl_temp
            tap_action:
              action: toggle
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Мониторинг
            secondary: |-
              {% if is_state(config.entity, 'on') %} Включено
              {% elif is_state(config.entity, 'off') %} Выключено
              {% elif is_state(config.entity, 'unavailable') %} Недоступно
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: automation.konditsioner_vkl_vykl_temp
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state('automation.konditsioner_vkl_vykl_temp',
                  'on')%} 

                  {% set weather = states('sensor.season') in ['summer',
                  'spring'] %}

                  {% set autumn =
                  state_attr('weather.iandeks_pogoda','temperature')|float(0) >
                  states('input_number.konditsioner_minimalnaia_temperatura_oseniu')|float(0)
                  and  states('sensor.season') in ['autumn'] %}

                  {% set balkon = states('binary_sensor.open_balcon_contact') !=
                  'on' %}

                  {% set winter = states('sensor.season') in ['winter'] and
                  state_attr('weather.iandeks_pogoda','temperature')|float(0) >
                  -5 %}


                  {% if( weather == true and balkon == true)

                  or
                   (autumn == true and balkon == true )
                  or

                  (winter == true and balkon == true ) == true %}
                  mdi:check-circle

                  {% else %} mdi:close-circle

                  {% endif%}

                  {% else %}  {% endif%}
                icon_color: >-
                  {% if is_state('automation.konditsioner_vkl_vykl_temp',
                  'on')%} 


                         {% set weather = states('sensor.season') in ['summer', 'spring'] %}
                         {% set autumn = state_attr('weather.iandeks_pogoda','temperature')|float(0) > states('input_number.konditsioner_minimalnaia_temperatura_oseniu')|float(0) and  states('sensor.season') in ['autumn'] %}
                         {% set balkon = states('binary_sensor.open_balcon_contact') != 'on' %}
                         {% set winter = states('sensor.season') in ['winter'] and state_attr('weather.iandeks_pogoda','temperature')|float(0) > -5 %}
                  {% if( weather == true and balkon == true)

                  or
                   (autumn == true and balkon == true )
                  or

                  (winter == true and balkon == true ) == true %} green

                  {% else %} red

                  {% endif%}

                  {% elif is_state('automation.konditsioner_vkl_vykl_temp',
                         'unavailable')%} 

                  {% else %} 

                  {% endif%}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: |+


            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            icon_color: "1"
            picture: ""
            tap_action:
              action: toggle
            hold_action:
              action: none
            entity: automation.budilnik_2
            fill_container: true
            badge_color: ""
            badge_icon: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Будильник
            secondary: |
              {% if is_state(config.entity, 'on') %} Вкл
              {% else %}  Выкл
              {% endif %}•

              {% set time1 = states.input_datetime.vremia.attributes.hour %}
              {% set time2 = states.input_datetime.vremia.attributes.minute %}

              {{ time1 }}:{% if time2<10 %}0{{ time2 }}
                          {% else %}{{ time2 }}
                          {% endif %}
            icon: ""
            icon_color: ""
            picture: ""
            tap_action:
              action: none
            entity: automation.budilnik_2
            fill_container: true
            badge_color: ""
            badge_icon: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            card_mod:
              style: >
                ha-card { 
                  background-color: rgba(255,255,255,0) }};
                --primary-text-color: {{ '#141414' if
                is_state('automation.budilnik_2', 'on') else ' ' }};

                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:pencil
                icon_color: "1"
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: input_datetime.vremia
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            icon_color: "1"
            picture: ""
            tap_action:
              action: toggle
            hold_action:
              action: more-info
            entity: automation.budilnik_po_kalendariu_melkaia
            fill_container: true
            badge_color: ""
            badge_icon: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Будильник
            secondary: >+
              {% set sec = state_attr('input_datetime.melkaya_wake_time',
              'hour') * 60 +  state_attr('input_datetime.melkaya_wake_time',
              'minute') %}

              {% if is_state('automation.budilnik_po_kalendariu_melkaia', 'on')
              %}
                {% if((now().date() + timedelta(days=1)) == as_datetime(state_attr('calendar.work_m', 'start_time')).date()) == True %} Завтра 
                {% elif as_timestamp((state_attr('calendar.work_m', 'start_time')))| timestamp_custom('%H:%M') < as_timestamp(now()) | timestamp_custom('%H:%M') and ((now().date() + timedelta(days=0)) == as_datetime(state_attr('calendar.work_m', 'start_time')).date()) == True%} Был 
                {% elif((now().date() + timedelta(days=0)) == as_datetime(state_attr('calendar.work_m', 'start_time')).date()) == True and as_timestamp((state_attr('calendar.work_m', 'start_time')))| timestamp_custom('%H:%M') > as_timestamp(now()) | timestamp_custom('%H:%M') %} Сегодня
                {% else %} {{ (as_timestamp(state_attr('calendar.work_m', 'start_time'))|timestamp_custom('%d.%m')) }}   
                {% endif %} в {{as_timestamp((as_datetime(state_attr('calendar.work_m', 'start_time'))) - timedelta(minutes=sec))| timestamp_custom('%H:%M') }}  
              {% else %} Выключен

              {% endif %}



            icon: ""
            icon_color: ""
            picture: ""
            tap_action:
              action: none
            fill_container: true
            badge_color: ""
            badge_icon: ""
            entity: automation.budilnik_po_kalendariu_melkaia
            hold_action:
              action: none
            double_tap_action:
              action: none
            card_mod:
              style: >
                ha-card { 
                  background-color: rgba(255,255,255,0) }};
                --primary-text-color: {{ '#141414' if
                is_state('automation.budilnik_po_kalendariu_melkaia', 'on') else
                ' ' }};

                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: calendar.work_m
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: conditional
            conditions:
              - condition: state
                entity: calendar.work_m
                state_not: unavailable
            card:
              type: custom:mushroom-chips-card
              chips:
                - type: template
                  icon: mdi:pencil
                  icon_color: "1"
                  tap_action:
                    action: more-info
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  entity: input_datetime.melkaya_wake_time
              alignment: end
              card_mod:
                style: |
                  ha-card {
                    position: absolute !important;
                    top: 0% !important;
                    right: 0% !important;
                    background-color: none !important;
                    --chip-background: none !important;
                    --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:alarm
            icon_color: "1"
            picture: ""
            tap_action:
              action: none
            hold_action:
              action: none
            fill_container: true
            badge_color: ""
            badge_icon: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Будильник
            secondary: >-
              {% if
              state_attr('calendar.yandex_station_m00en2100jayck_calendar','start_time')
              is none %}

              {% else %} 

              {%- set date =
              (as_timestamp('calendar.yandex_station_m00en2100jayck_calendar','start_time'))|float(0)
              -%}

              {% set day_now = as_timestamp(now()) |timestamp_custom('%d')|int
              %}

              {% set day =
              as_timestamp(state_attr('calendar.yandex_station_m00en2100jayck_calendar','start_time'))|timestamp_custom('%-d')
              %}

              {%- set month_list =
              ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря']
              %}

              {%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}

              {%- set month = month_list[m_ok-1] %}

              {% set month_int = as_timestamp(now()) |timestamp_custom('%m')|int
              %}

              {% set month_now = as_timestamp(now()) |timestamp_custom('%m')|int
              %}

              {% set time =
              as_timestamp(state_attr('calendar.yandex_station_m00en2100jayck_calendar','start_time'))
              |timestamp_custom('%H:%M') %}

              {% endif %}


              {% if
              state_attr('calendar.yandex_station_m00en2100jayck_calendar','start_time')
              is none %} Не установлен

              {% else %} 


              {% if (day == day_now ) and (month_now == month_int)%} Сегодня

              {% elif day|int - day_now|int == 1%} Завтра

               {% else %} {{day}} {{month}}
               {% endif %}
               в {{ time }}
              {% endif %}
            icon: ""
            icon_color: ""
            picture: ""
            tap_action:
              action: none
            entity: automation.budilnik_2
            fill_container: true
            badge_color: ""
            badge_icon: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            card_mod:
              style: >
                ha-card { 
                  background-color: rgba(255,255,255,0) }};
                --primary-text-color: {{ '#141414' if
                is_state('automation.budilnik_2', 'on') else ' ' }};

                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: yandex:station-mini-2
                icon_color: 150,150,150,0.2
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:lightbulb

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.ceilc_7cc294e765ce
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: transparent !important;
                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% if x > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.ceilc_7cc294e765ce
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card { 
                  background-color: transparent !important;
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.ceilc_7cc294e765ce
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        card_mod:
          style: |
            ha-card { 
              {% if is_state('light.ceilc_7cc294e765ce', 'on') %}
              border: 2px solid var(--ha-card-border-color, rgba(255,180,0.1)) !important;

              {% else %} 
              border: 2px solid var(--ha-card-border-color, rgba(100,100,100.1)) !important;
              --primary-text-color: rgba(100,100,100);
              {% endif %}
              border-radius: 25px;
            }
        grid_options:
          columns: 3
          rows: auto
    column_span: 6
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: light.vsia_gostinaia
                state_not: "122443"
            chip:
              type: template
              content: Балкон и улица
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
        layout_options:
          grid_columns: full
        card_mod:
          style: |
            ha-card {
              margin: 12px 0px 0px;
              --chip-background: none;
              --chip-border-width: 0;
              --chip-box-shadow: none;
              --chip-border-radius: 12px;
              --chip-height: 40px;
              --chip-padding: 14px;
              --chip-spacing: -35px;
              --chip-icon-size: 0.28em;
              --chip-font-size: 0.7em;
            }
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.balkon
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba({{state_attr(config.entity,'rgb_color')|replace ("(","")|replace (")","")}},0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: Свет
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% set y = (expand(config.entity) | map(attribute='entity_id') | list | count)%}
               {% if y > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.balkon
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.balkon
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: switch.tioplyi_pol
            tap_action:
              action: toggle
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba(255,20,20,0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: |-
              {% if is_state(config.entity, 'on') %} Включено
              {% elif is_state(config.entity, 'off') %} Выключено
              {% elif is_state(config.entity, 'unavailable') %} Недоступно
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: switch.tioplyi_pol
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: switch.tioplyi_pol
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: switch.konvektor
            tap_action:
              action: toggle
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba(255,20,20,0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: >-
              {% if state_attr(config.entity, 'friendly_name') != None %}
              {{state_attr(config.entity, 'friendly_name')}}

              {% else %} Устройство

              {% endif %}
            secondary: >+
              {% if is_state(config.entity, 'on')%} 


              {% if
              is_state('automation.avtomaticheskii_obogrev_balkona_po_temperature','on')%}

              Вкл › {{states('input_number.konvektor_temperatura_maksimum',
              'temperature')| float(0) | round(0) }}°

              {% else %}

              Включено

              {% endif %}


              {% elif is_state(config.entity, 'off')%} Выключено

              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Неизвестно

              {% endif%}


            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: switch.konvektor
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %}  mdi:thermometer-auto

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                    {% if is_state('automation.avtomaticheskii_obogrev_balkona_po_temperature', 'on')%} red
                    {% else %} 150,150,150,0.2
                    {% endif %}

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: switch.konvektor
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} fas:door-open
              {% else %} fas:door-closed
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: binary_sensor.open_balcon_contact
            tap_action:
              action: more-info
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Дверь
            secondary: >-
              {% if is_state('binary_sensor.open_balcon_contact', 'on')%}
              Открыто

              {% elif is_state('binary_sensor.open_balcon_contact', 'off')%}
              Закрыто

              {% else %} Неизвестно

              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.open_balcon_contact
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
            double_tap_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.open_balcon_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:home-thermometer
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.ble_temperature_a4c1386b69a7
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 0 %}  
                             {% set max = 35 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(120, 120, 180, 0.5) {{z}}%, 
                          rgba(120, 120, 180, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Климат
            secondary:  
            icon: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.ble_temperature_a4c1386b69a7
            icon_color: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% elif is_state(config.entity,'unknown')%} mdi:alert-circle

                  {% elif states('sensor.ble_battery_a4c1386b69a7')|int <= 20 %}
                  fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c1386b69a7
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c1386b69a7
                icon: mdi:thermometer
                content: |2-
                        {% if is_state(config.entity, 'unavailable') %}
                        Неизвестно {% else %} {{states(config.entity)|
                        float(0) | round(1)| replace(".",",")}}°  {% endif %}
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_humidity_a4c1386b69a7
                icon: mdi:water
                content: |2-
                        {% if is_state(config.entity, 'unavailable') %}
                        Неизвестно {% else %} {{states(config.entity)|
                        float(0) | round(1)| replace(".",",")}}%  {% endif %}
                icon_color: ""
            alignment: start
            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-height: 28px;
                  --chip-spacing: 0px;
                  margin-top: -31px;
                  margin-left: 0px;
                  margin-bottom: -27px; 
                  padding-bottom: 30px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:window-open-variant
              {% else %} mdi:window-closed-variant
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: binary_sensor.balkon_window_1_contact
            tap_action:
              action: more-info
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Окно (торец)
            secondary: |-
              {% if is_state(config.entity, 'on')%} Открыто
              {% elif is_state(config.entity, 'off')%} Закрыто
              {% else %} Неизвестно
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.balkon_window_1_contact
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >+
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}

                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.balkon_window_1_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:window-open-variant
              {% else %} mdi:window-closed-variant
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: binary_sensor.balkon_window_l_contact
            tap_action:
              action: more-info
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Окно (левое)
            secondary: |
              {% if is_state(config.entity, 'on')%} Открыто
              {% elif is_state(config.entity, 'off')%} Закрыто
              {% else %} Неизвестно
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.balkon_window_l_contact
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.balkon_window_l_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:window-open-variant
              {% else %} mdi:window-closed-variant
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: binary_sensor.balkon_window_r_contact
            tap_action:
              action: more-info
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Окно (правое)
            secondary: |-
              {% if is_state(config.entity, 'on')%} Открыто
              {% elif is_state(config.entity, 'off')%} Закрыто
              {% else %} Неизвестно
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.balkon_window_r_contact
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.balkon_window_r_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:run-fast
              {% else %} mdi:run
              {% endif %}
            entity: binary_sensor.motion_balkon_occupancy
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Балкон
            secondary: |-
              {% if is_state(config.entity, 'unavailable')%} Недоступно
              {% else %}

                 {% set time = as_timestamp(now()) - as_timestamp(states.binary_sensor.motion_balkon_occupancy.last_changed) %}
                 {% set days = (time // 86400) | int(0)%}
                 {% set hours = (time % 86400) // 3600 | int(0)%}
                 {% set minutes = ((time % 86400) % 3600) //60 | int(0)%}
                 {% set seconds = ((((time % 86400) % 3600) % 60)) | int(0) %}

                 {% if days > 370%} Более года назад
                 {% elif days > 185%} Более полугода назад
                 {% elif days > 95%} Более трёх месяцев назад
                 {% elif days > 62%} Более двух месяцев назад
                 {% elif days > 31%} Более месяца назад
                 {% elif days > 0 %} {{days| round()|format(morph='день', as_text=false) }} назад
                 {% elif days == 0 %}
                   {% if hours > 0 %} {{hours| round()|format(morph='час', as_text=false) }} назад
                   {% elif hours == 0 %}
                     {% if minutes > 0 %} {{minutes | round()|format(morph='минуту', as_text=false) }} назад
                     {% elif minutes == 0 %}
                       {% if seconds == 0 %} Только что
                       {% elif seconds > 0 %} {{seconds| round()|format(morph='секунду', as_text=false) }} назад
                       {% else %} Неизвестно
                       {% endif %}
                     {% endif %}
                   {% else %} 
                   {% endif %}
                 {% else %} 
                 {% endif %}
              {% endif %}
            icon: ""
            entity: binary_sensor.motion_balkon_occupancy
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: ""
            tap_action:
              action: more-info
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_occupancy","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.motion_balkon_occupancy
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: sensor.lux_balkon_illuminance
            tap_action:
              action: none
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = 10000 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(120, 120, 120, 0.5) {{z}}%, 
                          rgba(120, 120, 120, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Яркость
            secondary: |-
              {% if is_state(config.entity, 'unavailable')%} Недоступен
              {% else %} {{states(config.entity)}} Люкс
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: sensor.lux_balkon_illuminance
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_illuminance","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.lux_balkon_illuminance
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - show_state: false
            show_name: false
            camera_view: auto
            aspect_ratio: 55%
            type: picture-entity
            camera_image: camera.balkon
            entity: camera.balkon
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_balcon
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card {
                  height: 112px !important;
                  bottom: 0px !important;
                  left: 0px !important;
                  background-color: rgba(0,0,0,0.5) !important;
          - type: custom:mushroom-template-card
            primary: Улица
            secondary: Камера
            icon: ""
            entity: camera.balkon
            picture: ""
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_balcon
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  width:100%;
                  bottom: 0px !important;
                  left: 0px !important;
                  background-color: rgba(var(--rgb-card-background-color), 0.5);
                  }
                ha-card:hover { 
                  background-color: rgba(var(--rgb-card-background-color), 0.7);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: |2
                   {% if states(config.entity) in ['unknown', 'unavailable', 'none']  %} mdi:alert-circle
                   {% elif is_state('binary_sensor.balkon_person_detection', 'on')%} mdi:run-fast
                   {% elif is_state(config.entity,'on')%} mdi:motion

                   {% else %} 
                   {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red 

                  {% elif is_state(config.entity,'on')%} 1 

                  {% else %}  

                  {% endif %}
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.balkon_cell_motion_detection
            alignment: start
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  bottom: 8px !important;
                  right: 0px; !important;
                  --chip-background:  none !important;
                  --chip-height: 40px !important;
        grid_options:
          columns: 6
          rows: auto
        visibility:
          - condition: screen
            media_query: "(min-width: 1280px)"
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >
              {% if is_state(config.entity, 'rainy') %} mdi:weather-rainy

              {% elif is_state(config.entity, 'cloudy') %} mdi:weather-cloudy

              {% elif is_state(config.entity, 'hail') %} mdi:weather-hail

              {% elif is_state(config.entity, 'snowy') %} mdi:weather-snowy

              {% elif is_state(config.entity, 'sunny') %} mdi:weather-sunny

              {% elif is_state(config.entity, 'lightning') %}
              mdi:weather-lightning

              {% elif is_state(config.entity, 'windy') %} mdi:weather-windy

              {% elif is_state(config.entity, 'partlycloudy') %}
              mdi:weather-partly-cloudy

              {% elif is_state(config.entity, 'clear-day') %} mdi:weather-sunny

              {% elif is_state(config.entity, 'clear-night') %}
              mdi:weather-night

              {% elif is_state(config.entity, 'rain') %} mdi:weather-pouring

              {% elif is_state(config.entity, 'snow') %} mdi:weather-snowy-heavy

              {% elif is_state(config.entity, 'sleet') %}
              mdi:weather-snowy-rainy

              {% elif is_state(config.entity, 'wind') %} mdi:weather-dust  

              {% elif is_state(config.entity, 'fog') %} mdi:weather-fog

              {% elif is_state(config.entity, 'thunderstorm') %}
              mdi:weather-lightning

              {% elif is_state(config.entity, 'windy-variant') %}
              mdi:weather-windy

              {% elif is_state(config.entity, 'snowy-rainy') %}
              mdi:weather-snowy-rainy

              {% elif is_state(config.entity, 'pouring') %} mdi:weather-pouring

                {% else %} mdi:weather-cloudy-clock
                {% endif %}
            icon_color: |
              {% if is_state(config.entity, 'rainy') %} #687b8c
              {% elif is_state(config.entity, 'cloudy') %} #a5a7a8
              {% elif is_state(config.entity, 'hail') %} #a5a7a8
              {% elif is_state(config.entity, 'snowy') %} #c7c7c7
              {% elif is_state(config.entity, 'sunny') %} yellow
              {% elif is_state(config.entity, 'lightning') %} #97c9f7
              {% elif is_state(config.entity, 'windy') %} #929394
              {% elif is_state(config.entity, 'partlycloudy') %} #a5a7a8
              {% elif is_state(config.entity, 'clear-day') %} yellow
              {% elif is_state(config.entity, 'clear-night') %} #61defa
              {% elif is_state(config.entity, 'rain') %} #687b8c
              {% elif is_state(config.entity, 'snow') %} #c7c7c7
              {% elif is_state(config.entity, 'sleet') %} #a5a7a8
              {% elif is_state(config.entity, 'wind') %} #929394
              {% elif is_state(config.entity, 'fog') %} #a5a7a8
              {% elif is_state(config.entity, 'thunderstorm') %} #97c9f7
              {% elif is_state(config.entity, 'windy-variant') %} #929394
              {% elif is_state(config.entity, 'snowy-rainy') %} #c7c7c7
              {% elif is_state(config.entity, 'pouring') %} #687b8c

                {% else %} disabled
                {% endif %}
            entity: weather.iandeks_pogoda
            fill_container: true
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/weather
            picture: "{{state_attr(config.entity,'entity_picture')}}"
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-color1: none !important;
                    --icon-symbol1-size:30px;
                  }
                .: |
                  ha-card { 
                    background-color: rgba(255,255,255,0) }};
                  }  
          - type: custom:mushroom-template-card
            primary: >
              {% if states(config.entity) in ['unknown', 'unavailable', 'none'] 
              %} Погода

              {% else %}{{state_attr(config.entity, 'temperature')|float(0) |
              round()}}°

              {% endif %} •
                 {% if states(config.entity) in ['unknown', 'unavailable', 'none']  %}
                 Недоступно {% else %} {{state_translated(config.entity)}}
                 {% endif %}
            secondary: >-
              Ощущается  {% if states(config.entity)|float(0) ==
              state_attr(config.entity,'feelsLike') %} так же {% else %}как
              {{state_attr(config.entity,
              'apparent_temperature')|float(0)|round(0)}}°  {% endif %}
            icon: ""
            icon_color: ""
            entity: weather.iandeks_pogoda
            fill_container: true
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/weather
            picture: ""
            multiline_secondary: false
            badge_color: ""
            badge_icon: ""
            double_tap_action:
              action: none
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: weather.iandeks_pogoda
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 6
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: more-info
            entity: automation.avtomaticheskii_obogrev_balkona_po_temperature
            tap_action:
              action: toggle
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Автообогрев
            secondary: |-
              {% if is_state(config.entity, 'on') %} Включено
              {% elif is_state(config.entity, 'off') %} Выключено
              {% elif is_state(config.entity, 'unavailable') %} Недоступно
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: automation.avtomaticheskii_obogrev_balkona_po_temperature
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
        grid_options:
          columns: 3
          rows: auto
    column_span: 6
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: light.vsia_gostinaia
                state_not: "122443"
            chip:
              type: template
              content: Кухня
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
        layout_options:
          grid_columns: full
        card_mod:
          style: |
            ha-card {
              margin: 12px 0px 0px;
              --chip-background: none;
              --chip-border-width: 0;
              --chip-box-shadow: none;
              --chip-border-radius: 12px;
              --chip-height: 40px;
              --chip-padding: 14px;
              --chip-spacing: -35px;
              --chip-icon-size: 0.28em;
              --chip-font-size: 0.7em;
            }
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.kukhnia
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                          {% set min = 0.00001 %}
                          {% set maxx = state_attr('timer.svet_na_kukhne_po_dvizheniiu', 'duration') | default('00:00:00') %}
                          {% set max = (maxx.split(':')[-2] | int) * 60 %}
                          {% set finishes_at = state_attr('timer.svet_na_kukhne_po_dvizheniiu', 'finishes_at') %}
                          {% set x = (as_timestamp(finishes_at) if finishes_at is not none else as_timestamp(now())) - as_timestamp(now()) %}
                          {% set z = 100 * (x - min) / (max - min) | round(2) %}
                          
                          {% if is_state(config.entity, 'on') %}
                             {% if is_state('timer.svet_na_kukhne_po_dvizheniiu', 'active') %}
                               linear-gradient(90deg,
                                 rgba({{ state_attr(config.entity, 'rgb_color') | replace('(', '') | replace(')', '') }}, 0.4) {{ z }}%,
                                 rgba(255,0,0, 0.3) 0.1%  
                               ) !important;
                             {% else %}
                                   rgba({{ state_attr(config.entity, 'rgb_color') | replace('(', '') | replace(')', '') }}, 0.4)
                             {% endif %} 
                          {% else %}
                          {% endif %} 



                  }  
          - type: custom:mushroom-template-card
            primary: Кухня
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% set y = (expand(config.entity) | map(attribute='entity_id') | list | count)%}
               {% if y > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.kukhnia
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.kukhnia
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}} {% else %}
              yandex:station-lite {% endif %}
            entity: media_player.yandex_station_cyan
            picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
            badge_icon: ""
            badge_color: ""
            icon_color: "1"
            tap_action:
              action: perform-action
              perform_action: media_player.media_play_pause
              data: {}
              target:
                entity_id: media_player.yandex_station_cyan
            double_tap_action:
              action: none
            fill_container: true
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-color1: none !important;
                    --icon-symbol1-size:30px;
                  }
                .: |
                  ha-card { 
                    background-color: rgba(255,255,255,0) }};
                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if is_state(config.entity, 'playing') %} 
                {% if state_attr(config.entity,'media_title') is none %} Неизвестно
                {% else%} {{state_attr(config.entity, 'media_title')}}
                {% endif %}
              {% else %} Станция Лайт
              {% endif %}
            secondary: >-
              {% set x =
              state_attr('media_player.yandex_station_m00en2100jayck','media_position')|float(0)|round(0)
              %}

              {% set y =
              state_attr('media_player.yandex_station_beige','media_position')|float(0)|round(0)
              %}

              {% set z =
              state_attr('media_player.yandex_station_purple','media_position')|float(0)|round(0)
              %} {% set a =
              state_attr('media_player.yandex_station_cyan','media_position')|float(0)|round(0)
              %}

              {% if is_state(config.entity, 'playing') %}
                 {% if is_state('binary_sensor.multirum_sostoianie','on')%} 
                   {% set time = ([x, y, z, a]|max) %} 
                   {{as_timestamp(as_datetime(time))| timestamp_custom('%-M:%S') }} • Везде
                 {% else %} {{as_timestamp(as_datetime(a))| timestamp_custom('%-M:%S') }}
                 {% endif %}
              {% elif states(config.entity) in ['unknown', 'unavailable',
              'none']  %} Недоступно

              {% else %} Бездействие

              {% endif %}
            icon: ""
            entity: media_player.yandex_station_cyan
            picture: ""
            badge_icon: ""
            badge_color: ""
            icon_color: ""
            double_tap_action:
              action: none
            fill_container: true
            hold_action:
              action: none
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/station_cyan
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 
                    {% if is_state_attr(config.entity, 'alice_state', 'LISTENING') %} mdi:ear-hearing 
                    {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
                    {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
                    {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
                    {% else %} mdi:sleep
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_cyan
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
        visibility:
          - condition: state
            entity: media_player.yandex_station_cyan
            state_not: playing
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: yandex:station-lite
            entity: media_player.yandex_station_cyan
            picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
            badge_icon: ""
            badge_color: ""
            icon_color: "1"
            tap_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            layout: horizontal
            hold_action:
              action: none
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:24px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'playing')%}
                        {% if state_attr(config.entity,'media_duration') != None %}
                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = state_attr(config.entity,'media_duration')|int(0) %}
                             {% set x = state_attr(config.entity,'media_position')|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(0, 225, 255, 1) {{z}}%, 
                          rgba(0, 225, 255, 0.5) 0.1%) !important;
                        {% else %} 
                         background: rgb(120,120,120)   
                        {% endif %}
                   {% else %}
                   {% endif %}


                  }  
          - type: custom:mushroom-template-card
            primary: |+
              {% if is_state(config.entity, 'playing') %} 
                {% if state_attr(config.entity,'media_title') is none %} Неизвестно
                {% else%} {{state_attr(config.entity, 'media_title')}}
                {% endif %}
              {% else %} Станция Лайт
              {% endif %}




            secondary: >-
              {% set g =
              state_attr('media_player.yandex_station_m00en2100jayck','media_position')|float(0)|round(0)
              %}

              {% set b =
              state_attr('media_player.yandex_station_beige','media_position')|float(0)|round(0)
              %}

              {% set p =
              state_attr('media_player.yandex_station_purple','media_position')|float(0)|round(0)
              %}

              {% set c =
              state_attr('media_player.yandex_station_cyan','media_position')|float(0)|round(0)
              %}


              {% if is_state(config.entity, 'playing') %}
                 {% if is_state('binary_sensor.multirum_sostoianie','on')%} 
                   {% set time = ([g, b, p, c]|max) %} 
                   {{as_timestamp(as_datetime(time))| timestamp_custom('%-M:%S') }} • Везде
                 {% else %} {{as_timestamp(as_datetime(c))| timestamp_custom('%-M:%S') }}
                 {% endif %}
              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Бездействие

              {% endif %}
            icon: ""
            entity: media_player.yandex_station_cyan
            picture: ""
            badge_icon: ""
            badge_color: 17,17,17
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/station_cyan
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state(config.entity, 'unavailable') %}
                  mdi:alert-circle

                  {% else %} 
                    {% if is_state_attr(config.entity, 'alice_state', 'LISTENING') %} mdi:ear-hearing 
                    {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
                    {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
                    {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
                    {% else %} mdi:sleep
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_cyan
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  left: 45px !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: mdi:skip-previous
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_previous_track
                  target:
                    entity_id:
                      - media_player.yandex_station_cyan
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 75px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: |-
                  {% if is_state(config.entity, 'paused')%}mdi:play
                  {% elif is_state(config.entity, 'playing')%}mdi:pause
                  {% else %} mdi:lock
                  {% endif %}
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    entity_id: media_player.yandex_station_cyan
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_cyan
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 40px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: mdi:skip-next
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_next_track
                  target:
                    entity_id: media_player.yandex_station_cyan
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 5px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 6
          rows: auto
        visibility:
          - condition: state
            entity: media_player.yandex_station_cyan
            state: playing
      - type: custom:vertical-stack-in-card
        cards:
          - show_state: false
            show_name: false
            camera_view: auto
            aspect_ratio: 55%
            type: picture-entity
            camera_image: camera.kukhnia
            entity: camera.kukhnia
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_kuh
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card {
                  height: 112px !important;
                  bottom: 0px !important;
                  left: 0px !important;
                  background-color: rgba(0,0,0,0.5) !important;
          - type: custom:mushroom-template-card
            primary: Кухня
            secondary: Камера
            icon: ""
            entity: camera.kukhnia
            picture: ""
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_kuh
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  width:100%;
                  bottom: 0px !important;
                  left: 0px !important;
                  background-color: rgba(var(--rgb-card-background-color), 0.5);
                  }
                ha-card:hover { 
                  background-color: rgba(var(--rgb-card-background-color), 0.7);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: |2-
                   {% if states(config.entity) in ['unknown', 'unavailable', 'none']  %} mdi:alert-circle
                   {% elif is_state(config.entity,'on')%} mdi:run-fast
                   {% else %} 
                   {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red 

                  {% elif is_state(config.entity,'on')%} 1 

                  {% else %}  

                  {% endif %}
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.motion_kuhnya_occupancy
            alignment: start
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  bottom: 8px !important;
                  right: 0px; !important;
                  --chip-background:  none !important;
                  --chip-height: 40px !important;
        grid_options:
          columns: 6
          rows: auto
        visibility:
          - condition: screen
            media_query: "(min-width: 1280px)"
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            entity: water_heater.polaris_kettle
            tap_action:
              action: perform-action
              perform_action: switch.toggle
              data: {}
              target:
                entity_id:
                  - switch.polaris_kettle
            icon_color: "1"
            fill_container: true
            double_tap_action:
              action: none
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% if states(config.entity) == 'off' %} 
                               {% if state_attr(config.entity, 'current_temperature')|float(0) >= 90 %} 
                                 {% set rgb = '90, 0, 0' %}
                               {% else %} 
                                 {% set rgb = '120, 120, 120' %}
                               {% endif %}
                             {% else %} 
                               {% if state_attr(config.entity, 'current_temperature')|float(0) > 90 %} 
                                 {% set rgb = '255, 0, 0' %}
                               {% elif state_attr(config.entity, 'current_temperature')|float(0) > 60 %} 
                                 {% set rgb = '255, 106, 0' %}
                               {% elif state_attr(config.entity, 'current_temperature')|float(0) > 40 %} 
                                 {% set rgb = '255, 183, 0' %}
                               {% elif state_attr(config.entity, 'current_temperature')|float(0) > 30 %} 
                                 {% set rgb = '56, 40, 0' %}

                               {% else %} 
                                 {% set rgb = '120, 120, 120' %}
                               {% endif %}

                             {% endif %}
                             {% set min = 0.000001 %}  
                             {% set max = 100 %}
                             {% set x = state_attr(config.entity, 'current_temperature')|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba({{rgb}}, 0.5) {{z}}%, 
                          rgba({{rgb}}, 0.1) 0.1%) !important;

                  }  
          - type: custom:mushroom-template-card
            primary: Чайник
            secondary: >-
              {% if is_state(config.entity, 'unavailable') %} Недоступно   

              {% elif not is_state(config.entity, 'off') %} Вкл •
              {{state_attr(config.entity, 'current_temperature')}}°

              {% elif is_state(config.entity, 'off') %} Выкл •
              {{state_attr(config.entity, 'current_temperature')}}° 

              {% else %} Неизвестно

              {% endif %}
            icon: ""
            entity: water_heater.polaris_kettle
            tap_action:
              action: more-info
            icon_color: ""
            hold_action:
              action: none
            fill_container: true
            double_tap_action:
              action: none
            badge_icon: ""
            badge_color: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: water_heater.polaris_kettle
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:fridge-bottom
              {% else %} mdi:fridge-outline
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.holodilnik_contact
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Холодильник
            secondary:  
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            entity: binary_sensor.holodilnik_contact
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card { 
                  background-color: rgba(255,255,255,0) }};

                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.holodilnik_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c13836991a
                icon: "{{states[config.entity].attributes.icon}}"
                content: |2-
                        {% if is_state('sensor.ble_temperature_a4c13836991a', 'unavailable') %}
                        Неизвестно {% else %} {{states('sensor.ble_temperature_a4c13836991a')|
                        float(0) | round(1)| replace(".",",")}}°  {% endif %}
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.holodilnik_contact
                icon: "{{states[config.entity].attributes.icon}}"
                content: |-
                  {% if is_state(config.entity, 'on')%} Открыто
                  {% elif is_state(config.entity, 'off')%} Закрыто
                  {% else %} Неизвестно
                  {% endif%}
            alignment: start
            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-height: 28px;
                  --chip-spacing: 0px;
                  margin-top: -31px;
                  margin-left: 2px;
                  margin-bottom: -27px; 
                  padding-bottom: 30px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:fridge-top
              {% else %} mdi:fridge-outline
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: binary_sensor.open_morozilka_contact
            tap_action:
              action: more-info
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Морозилка
            secondary:  
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.open_morozilka_contact
            double_tap_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.open_morozilka_contact
                icon: "{{states[config.entity].attributes.icon}}"
                content: |-
                  {% if is_state(config.entity, 'on')%} Открыто
                  {% elif is_state(config.entity, 'off')%} Закрыто
                  {% else %} Неизвестно
                  {% endif%}
            alignment: start
            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-height: 28px;
                  --chip-spacing: 0px;
                  margin-top: -31px;
                  margin-left: 3px;
                  margin-bottom: -27px; 
                  padding-bottom: 30px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >+
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}

                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.open_morozilka_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:cup-water
              {% else %} mdi:cup-outline
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.fridge_dry_water_leak
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba(255,0,0,1);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Конденсат
            secondary: |-
              {% if is_state(config.entity, 'on')%} Обнаружено
              {% elif is_state(config.entity, 'off')%} Сухо
              {% else %} Неизвестно
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.fridge_dry_water_leak
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_water_leak","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.fridge_dry_water_leak
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:home-thermometer
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.ble_temperature_a4c1383c7442
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 25 %}  
                             {% set max = 35 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(120, 120, 180, 0.5) {{z}}%, 
                          rgba(120, 120, 180, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Климат
            secondary:  
            icon: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.ble_temperature_a4c1383c7442
            icon_color: ""
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c1383c7442
                icon: mdi:thermometer
                content: |2-
                        {% if is_state(config.entity, 'unavailable') %}
                        Неизвестно {% else %} {{states(config.entity)|
                        float(0) | round(1)| replace(".",",")}}°  {% endif %}
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_humidity_a4c1383c7442
                icon: mdi:water
                content: |2-
                        {% if is_state(config.entity, 'unavailable') %}
                        Неизвестно {% else %} {{states(config.entity)|
                        float(0) | round(1)| replace(".",",")}}%  {% endif %}
                icon_color: ""
            alignment: start
            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-height: 28px;
                  --chip-spacing: 0px;
                  margin-top: -31px;
                  margin-left: 0px;
                  margin-bottom: -27px; 
                  padding-bottom: 30px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% elif is_state(config.entity,'unknown')%} mdi:alert-circle

                  {% elif states('sensor.ble_battery_a4c1383c7442')|int <= 20 %}
                  fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c1383c7442
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:window-open-variant
              {% else %} mdi:window-closed-variant
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: binary_sensor.kuhnya_window_contact
            tap_action:
              action: more-info
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Окно
            secondary: |-
              {% if is_state(config.entity, 'on')%} Открыто
              {% elif is_state(config.entity, 'off')%} Закрыто
              {% else %} Неизвестно
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.kuhnya_window_contact
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.kuhnya_window_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: sensor.lux_kuh_illuminance
            tap_action:
              action: none
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = 2000 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(120, 120, 120, 0.5) {{z}}%, 
                          rgba(120, 120, 120, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Яркость
            secondary: |-
              {% if is_state(config.entity, 'unavailable')%} Недоступен
              {% else %} {{states(config.entity)}} Люкс
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: sensor.lux_kuh_illuminance
            double_tap_action:
              action: none
            card_mod:
              style: >
                ha-card { 
                  background-color: rgba(255,255,255,0) }};

                --primary-text-color: {{ '#141414' if
                states('sensor.lux_balkon_illuminance ')|float(0) > 100 else ' '
                }};

                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_illuminance","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.lux_kuh_illuminance
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:water-alert
              {% else %} mdi:water-off
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.dry_kuhnya_water_leak
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba(255,0,0,1);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Протечка
            secondary: |-
              {% if is_state(config.entity, 'on')%} Протечка!
              {% elif is_state(config.entity, 'off')%} Сухо
              {% else %} Неизвестно
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.dry_kuhnya_water_leak
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_water_leak","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.dry_kuhnya_water_leak
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:run-fast
              {% else %} mdi:run
              {% endif %}
            entity: binary_sensor.motion_kuhnya_occupancy
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Движение
            secondary: |-
              {% if is_state(config.entity, 'unavailable')%} Недоступно
              {% else %}

                 {% set time = as_timestamp(now()) - as_timestamp(states.binary_sensor.motion_kuhnya_occupancy.last_changed) %}
                 {% set days = (time // 86400) | int(0)%}
                 {% set hours = (time % 86400) // 3600 | int(0)%}
                 {% set minutes = ((time % 86400) % 3600) //60 | int(0)%}
                 {% set seconds = ((((time % 86400) % 3600) % 60)) | int(0) %}

                 {% if days > 370%} Более года назад
                 {% elif days > 185%} Более полугода назад
                 {% elif days > 95%} Более трёх месяцев назад
                 {% elif days > 62%} Более двух месяцев назад
                 {% elif days > 31%} Более месяца назад
                 {% elif days > 0 %} {{days| round()|format(morph='день', as_text=false) }} назад
                 {% elif days == 0 %}
                   {% if hours > 0 %} {{hours| round()|format(morph='час', as_text=false) }} назад
                   {% elif hours == 0 %}
                     {% if minutes > 0 %} {{minutes | round()|format(morph='минуту', as_text=false) }} назад
                     {% elif minutes == 0 %}
                       {% if seconds == 0 %} Только что
                       {% elif seconds > 0 %} {{seconds| round()|format(morph='секунду', as_text=false) }} назад
                       {% else %} Неизвестно
                       {% endif %}
                     {% endif %}
                   {% else %} 
                   {% endif %}
                 {% else %} 
                 {% endif %}
              {% endif %}
            icon: ""
            entity: binary_sensor.motion_kuhnya_occupancy
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: ""
            tap_action:
              action: more-info
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_occupancy","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.motion_kuhnya_occupancy
                content: ""
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
    column_span: 6
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: light.vsia_gostinaia
                state_not: "122443"
            chip:
              type: template
              content: Ванная
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
        layout_options:
          grid_columns: full
        card_mod:
          style: |
            ha-card {
              margin: 12px 0px 0px;
              --chip-background: none;
              --chip-border-width: 0;
              --chip-box-shadow: none;
              --chip-border-radius: 12px;
              --chip-height: 40px;
              --chip-padding: 14px;
              --chip-spacing: -35px;
              --chip-icon-size: 0.28em;
              --chip-font-size: 0.7em;
            }
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.vannaia
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba({{state_attr(config.entity,'rgb_color')|replace ("(","")|replace (")","")}},0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: Свет
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% set y = (expand(config.entity) | map(attribute='entity_id') | list | count)%}
               {% if y > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.vannaia
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.vannaia
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}} {% else %} mdi:devices {%
              endif %}
            entity: media_player.yandex_station_beige
            picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
            badge_icon: ""
            badge_color: ""
            icon_color: "1"
            tap_action:
              action: perform-action
              perform_action: media_player.media_play_pause
              data: {}
              target:
                entity_id: media_player.yandex_station_beige
            double_tap_action:
              action: none
            fill_container: true
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-color1: none !important;
                    --icon-symbol1-size:30px;
                  }
                .: |
                  ha-card { 
                    background-color: rgba(255,255,255,0) }};
                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if is_state(config.entity, 'playing') %} 
                {% if state_attr(config.entity,'media_title') is none %} Неизвестно
                {% else%} {{state_attr(config.entity, 'media_title')}}
                {% endif %}
              {% else %} Станция Лайт
              {% endif %}
            secondary: >-
              {% set x =
              state_attr('media_player.yandex_station_m00en2100jayck','media_position')|float(0)|round(0)
              %}

              {% set y =
              state_attr('media_player.yandex_station_beige','media_position')|float(0)|round(0)
              %}

              {% set z =
              state_attr('media_player.yandex_station_purple','media_position')|float(0)|round(0)
              %}


              {% if is_state(config.entity, 'playing') %}
                 {% if is_state('binary_sensor.multirum_sostoianie','on')%} 
                   {% set time = ([x, y, z]|max) %} 
                   {{as_timestamp(as_datetime(time))| timestamp_custom('%-M:%S') }} • Везде
                 {% else %} {{as_timestamp(as_datetime(y))| timestamp_custom('%-M:%S') }}
                 {% endif %}
              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Бездействие

              {% endif %}
            icon: ""
            entity: media_player.yandex_station_beige
            picture: ""
            badge_icon: ""
            badge_color: ""
            icon_color: ""
            double_tap_action:
              action: none
            fill_container: true
            hold_action:
              action: none
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/yandex-lite-bath
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state(config.entity, 'unavailable') %}
                  mdi:alert-circle

                  {% else %} 
                    {% if is_state_attr(config.entity, 'alice_state', 'LISTENING') %} mdi:ear-hearing 
                    {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
                    {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
                    {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
                    {% else %} mdi:sleep
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_beige
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
        visibility:
          - condition: state
            entity: media_player.yandex_station_beige
            state_not: playing
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: yandex:station-lite
            entity: media_player.yandex_station_beige
            picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
            badge_icon: ""
            badge_color: ""
            icon_color: "1"
            tap_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            layout: horizontal
            hold_action:
              action: none
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:24px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'playing')%}
                        {% if state_attr(config.entity,'media_duration') != None %}
                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = state_attr(config.entity,'media_duration')|int(0) %}
                             {% set x = state_attr(config.entity,'media_position')|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(216, 175, 151, 1) {{z}}%, 
                          rgba(216, 175, 151, 0.5) 0.1%) !important;
                        {% else %} 
                         background: rgb(120,120,120)   
                        {% endif %}
                   {% else %}
                   {% endif %}


                  }  
          - type: custom:mushroom-template-card
            primary: |+
              {% if is_state(config.entity, 'playing') %} 
                {% if state_attr(config.entity,'media_title') is none %} Неизвестно
                {% else%} {{state_attr(config.entity, 'media_title')}}
                {% endif %}
              {% else %} Станция Лайт
              {% endif %}




            secondary: >-
              {% set g =
              state_attr('media_player.yandex_station_m00en2100jayck','media_position')|float(0)|round(0)
              %}

              {% set b =
              state_attr('media_player.yandex_station_beige','media_position')|float(0)|round(0)
              %}

              {% set p =
              state_attr('media_player.yandex_station_purple','media_position')|float(0)|round(0)
              %}

              {% set c =
              state_attr('media_player.yandex_station_cyan','media_position')|float(0)|round(0)
              %}


              {% if is_state(config.entity, 'playing') %}
                 {% if is_state('binary_sensor.multirum_sostoianie','on')%} 
                   {% set time = ([g, b, p, c]|max) %} 
                   {{as_timestamp(as_datetime(time))| timestamp_custom('%-M:%S') }} • Везде
                 {% else %} {{as_timestamp(as_datetime(b))| timestamp_custom('%-M:%S') }}
                 {% endif %}
              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Бездействие

              {% endif %}
            icon: ""
            entity: media_player.yandex_station_beige
            picture: ""
            badge_icon: ""
            badge_color: 17,17,17
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/yandex-lite-bath
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state(config.entity, 'unavailable') %}
                  mdi:alert-circle

                  {% else %} 
                    {% if is_state_attr(config.entity, 'alice_state', 'LISTENING') %} mdi:ear-hearing 
                    {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
                    {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
                    {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
                    {% else %} mdi:sleep
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_beige
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  left: 45px !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: mdi:skip-previous
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_previous_track
                  target:
                    entity_id:
                      - media_player.yandex_station_beige
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 75px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: |-
                  {% if is_state(config.entity, 'paused')%}mdi:play
                  {% elif is_state(config.entity, 'playing')%}mdi:pause
                  {% else %} mdi:lock
                  {% endif %}
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    entity_id: media_player.yandex_station_beige
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_beige
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 40px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: mdi:skip-next
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_next_track
                  target:
                    entity_id: media_player.yandex_station_beige
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 5px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 6
          rows: auto
        visibility:
          - condition: state
            entity: media_player.yandex_station_beige
            state: playing
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: fas:spray-can-sparkles
            badge_icon: ""
            tap_action:
              action: toggle
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            entity: switch.air_fresher
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = 100 %}
                             {% set x = states('sensor.air_fresh_vol')|int %}

                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%

                          {% if is_state(config.entity, 'on')%}  
                              rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4) 
                          {% else %}
                              linear-gradient(90deg, 
                              rgba(120,120,120,0.4) {{z}}%, 
                              rgba(120,120,120,0.1) 0.1%) !important;
                          {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Освежитель
            secondary: >-
              {{states(config.entity)|int(0)}}% •
              {{states('sensor.prognoz_vremeni_osvezhitelia')}} дн.
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            entity: sensor.air_fresh_vol
            card_mod:
              style: |
                ha-card { 


                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.nisha
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:lightbulb

              {% endif %}
            badge_icon: ""
            tap_action:
              action: none
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            entity: binary_sensor.washing_machine
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = 3600 %}
                             {% set x = as_timestamp(states.timer.washing.attributes.finishes_at) - as_timestamp(now()) %}

                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                        {% if is_state(config.entity, 'on') %}
                          {% if is_state('timer.washing', 'active') %}
                            linear-gradient(90deg, 
                            rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4) {{z}}%, 
                            rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.1) 0.1%) !important;
                            
                          {% else %} rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4)
                          {% endif %}
                        {% else %}
                        {% endif %}




                  }  
          - type: custom:mushroom-template-card
            primary: Стиральная машина
            secondary: |-
              {% if is_state(config.entity, 'on')%} Стирка
               {% if is_state('timer.washing', 'active') %}
                {% set time = as_timestamp(states.timer.washing.attributes.finishes_at) - as_timestamp(now()) %}
                {% set days = (time // 86400) | int(0)%}
                {% set hours = (time % 86400) // 3600 | int(0)%}
                {% set minutes = ((time % 86400) % 3600) //60 | int(0)%}
                {% set seconds = ((((time % 86400) % 3600) % 60)) | int(0) %}
               
                • {{minutes | round(0)}}:{%if seconds <10 %}0{{seconds| round(0)}}{% else %}{{seconds | round(0)}}

                {% endif %}
              {% else %}
              {% endif %}
              {% else %} Выключено
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.washing_machine
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% elif
                  is_state('binary_sensor.open_wash_contact','unavailable') %}
                  mdi:alert-circle

                  {% elif states('sensor.open_wash_battery')|int <= 20 %}
                  fas:battery-quarter

                  {% else %} 
                   {% if is_state('binary_sensor.open_wash_contact', 'on')%} mdi:lock-open-variant
                   {% elif is_state('binary_sensor.open_wash_contact', 'off')%} mdi:lock
                   {% else %} 
                   {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% elif
                  is_state('binary_sensor.open_wash_contact','unavailable') %}
                  red

                  {% elif states('sensor.open_wash_battery')|int <= 20 %} <= 20
                  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: switch.wash_m
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:home-thermometer
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.ble_temperature_a4c138bc879f
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                             {% set min = 0 %}  
                             {% set max = 35 %}
                             {% set x = states(config.entity)|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(120, 120, 180, 0.5) {{z}}%, 
                          rgba(120, 120, 180, 0.1) 0.1%) !important;



                  }  
          - type: custom:mushroom-template-card
            primary: Климат
            secondary:  
            icon: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            double_tap_action:
              action: none
            picture: ""
            badge_color: ""
            fill_container: true
            badge_icon: ""
            entity: sensor.ble_temperature_a4c138bc879f
            icon_color: ""
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% elif is_state(config.entity,'unknown')%} mdi:alert-circle

                  {% elif states('sensor.ble_battery_a4c1386b69a7')|int <= 20 %}
                  fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c138bc879f
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_temperature_a4c138bc879f
                icon: mdi:thermometer
                content: |2-
                        {% if is_state(config.entity, 'unavailable') %}
                        Неизвестно {% else %} {{states(config.entity)|
                        float(0) | round(1)| replace(".",",")}}°  {% endif %}
              - type: template
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.ble_humidity_a4c138bc879f
                icon: mdi:water
                content: |2-
                        {% if is_state(config.entity, 'unavailable') %}
                        Неизвестно {% else %} {{states(config.entity)|
                        float(0) | round(1)| replace(".",",")}}%  {% endif %}
                icon_color: ""
            alignment: start
            card_mod:
              style: |
                ha-card > .chip-container {
                  flex-wrap: nowrap;
                  overflow-x: scroll;
                  overflow-y: hidden;
                  --chip-height: 28px;
                  --chip-spacing: 0px;
                  margin-top: -31px;
                  margin-left: 0px;
                  margin-bottom: -27px; 
                  padding-bottom: 30px;
                }

                ha-card > .chip-container > * {
                  flex-shrink: 0;
                }
                ha-card {
                  --ha-card-border-width: 0;
                  background-color: rgba(var(--rgb-card-background-color),0);
                  --chip-background: none;
                  --chip-font-weight: normal; 
                  --chip-font-size: 12px;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:water-alert
              {% else %} mdi:water-off
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.dry_stoyak_water_leak
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba(255,0,0,1);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Стояк
            secondary: |-
              {% if is_state(config.entity, 'on')%} Протечка!
              {% elif is_state(config.entity, 'off')%} Сухо
              {% else %} Неизвестно
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.dry_stoyak_water_leak
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_water_leak","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.dry_stoyak_water_leak
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:water-alert
              {% else %} mdi:water-off
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.water_bath_water_leak
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba(255,0,0,1);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Под ванной
            secondary: >-
              {% if is_state('binary_sensor.water_bath_water_leak', 'on')%}
              Протечка!

              {% elif is_state('binary_sensor.water_bath_water_leak', 'off')%}
              Сухо

              {% else %} Неизвестно

              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.water_bath_water_leak
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_water_leak","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.water_bath_water_leak
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} fas:door-open
              {% else %} fas:door-closed
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: binary_sensor.open_bath_contact
            tap_action:
              action: more-info
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Дверь
            secondary: |-
              {% if is_state(config.entity, 'on')%} Открыто
              {% elif is_state(config.entity, 'off')%} Закрыто
              {% else %} Неизвестно
              {% endif%}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.open_bath_contact
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_contact","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.open_bath_contact
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} 
                {% if is_state('binary_sensor.bathroom_presence_moving_target', 'on')%} mdi:run
                {% elif is_state('binary_sensor.bathroom_presence_still_target', 'on')%} mdi:human-male
                {% endif %}
              {% else %} mdi:motion-sensor-off
              {% endif %}
            entity: binary_sensor.bathroom_presence_presence
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Движение
            secondary: |-
              {% if is_state(config.entity, 'unavailable')%} Недоступно
              {% else %}

                 {% set time = as_timestamp(now()) - as_timestamp(states.binary_sensor.bathroom_presence_presence.last_changed) %}
                 {% set days = (time // 86400) | int(0)%}
                 {% set hours = (time % 86400) // 3600 | int(0)%}
                 {% set minutes = ((time % 86400) % 3600) //60 | int(0)%}
                 {% set seconds = ((((time % 86400) % 3600) % 60)) | int(0) %}

                 {% if days > 370%} Более года назад
                 {% elif days > 185%} Более полугода назад
                 {% elif days > 95%} Более трёх месяцев назад
                 {% elif days > 62%} Более двух месяцев назад
                 {% elif days > 31%} Более месяца назад
                 {% elif days > 0 %} {{days| round()|format(morph='день', as_text=false) }} назад
                 {% elif days == 0 %}
                   {% if hours > 0 %} {{hours| round()|format(morph='час', as_text=false) }} назад
                   {% elif hours == 0 %}
                     {% if minutes > 0 %} {{minutes | round()|format(morph='минуту', as_text=false) }} назад
                     {% elif minutes == 0 %}
                       {% if seconds == 0 %} Только что
                       {% elif seconds > 0 %} {{seconds| round()|format(morph='секунду', as_text=false) }} назад
                       {% else %} Неизвестно
                       {% endif %}
                     {% endif %}
                   {% else %} 
                   {% endif %}
                 {% else %} 
                 {% endif %}
              {% endif %}
            icon: ""
            entity: binary_sensor.bathroom_presence_presence
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: ""
            tap_action:
              action: more-info
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >+
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}

                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.bathroom_presence_presence
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
    column_span: 6
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: light.vsia_gostinaia
                state_not: "122443"
            chip:
              type: template
              content: Прихожая
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
        layout_options:
          grid_columns: full
        card_mod:
          style: |
            ha-card {
              margin: 12px 0px 0px;
              --chip-background: none;
              --chip-border-width: 0;
              --chip-box-shadow: none;
              --chip-border-radius: 12px;
              --chip-height: 40px;
              --chip-padding: 14px;
              --chip-spacing: -35px;
              --chip-icon-size: 0.28em;
              --chip-font-size: 0.7em;
            }
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}}

              {% else %} mdi:devices

              {% endif %}
            badge_icon: ""
            tap_action:
              action: toggle
            entity: light.prikhozhaia
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 

                        background: 
                          {% set min = 0.00001 %}
                          {% set maxx = state_attr('timer.svet_v_prikhozhei_po_dvizheniiu', 'duration') | default('00:00:00') %}
                          {% set max = (maxx.split(':')[-2] | int) * 60 %}
                          {% set finishes_at = state_attr('timer.svet_v_prikhozhei_po_dvizheniiu', 'finishes_at') %}
                          {% set x = (as_timestamp(finishes_at) if finishes_at is not none else as_timestamp(now())) - as_timestamp(now()) %}
                          {% set z = 100 * (x - min) / (max - min) | round(2) %}
                          
                          {% if is_state(config.entity, 'on') %}
                             {% if is_state('timer.svet_v_prikhozhei_po_dvizheniiu', 'active') %}
                               linear-gradient(90deg,
                                 rgba({{ state_attr(config.entity, 'rgb_color') | replace('(', '') | replace(')', '') }}, 0.4) {{ z }}%,
                                 rgba(255,0,0, 0.3) 0.1%  
                               ) !important;
                             {% else %}
                                   rgba({{ state_attr(config.entity, 'rgb_color') | replace('(', '') | replace(')', '') }}, 0.4)
                             {% endif %} 
                          {% else %}
                          {% endif %} 



                  }  
          - type: custom:mushroom-template-card
            primary: Свет
            secondary: |-
              {% if is_state(config.entity, 'on') %}
               {% set x = (expand(config.entity) | selectattr('state', 'eq', 'on') | map(attribute='entity_id') | list | count)  %}
               {% set y = (expand(config.entity) | map(attribute='entity_id') | list | count)%}
               {% if y > 1 %} {{x}} вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% else %} Вкл • {{(state_attr(config.entity, 'brightness')|float(0)/255*100)|round()}}%
               {% endif %}
              {% elif is_state(config.entity, 'off') %} Выключено
              {% else %} Недоступно
              {% endif %}
            icon: ""
            badge_icon: ""
            tap_action:
              action: more-info
            entity: light.prikhozhaia
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} mdi:alert-circle

                  {% else %} 

                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: light.prikhozhaia
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: >-
              {% if state_attr(config.entity, 'icon') != None %}
              {{state_attr(config.entity, 'icon')}} {% else %} mdi:devices {%
              endif %}
            entity: media_player.yandex_station_purple
            picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
            badge_icon: ""
            badge_color: ""
            icon_color: "1"
            tap_action:
              action: perform-action
              perform_action: media_player.media_play_pause
              data: {}
              target:
                entity_id: media_player.yandex_station_purple
            double_tap_action:
              action: none
            fill_container: true
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-color1: none !important;
                    --icon-symbol1-size:30px;
                  }
                .: |
                  ha-card { 
                    background-color: rgba(255,255,255,0) }};
                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if is_state(config.entity, 'playing') %} 
                {% if state_attr(config.entity,'media_title') is none %} Неизвестно
                {% else%} {{state_attr(config.entity, 'media_title')}}
                {% endif %}
              {% else %} Станция Лайт
              {% endif %}
            secondary: >-
              {% set x =
              state_attr('media_player.yandex_station_m00en2100jayck','media_position')|float(0)|round(0)
              %}

              {% set y =
              state_attr('media_player.yandex_station_beige','media_position')|float(0)|round(0)
              %}

              {% set z =
              state_attr('media_player.yandex_station_purple','media_position')|float(0)|round(0)
              %}


              {% if is_state(config.entity, 'playing') %}
                 {% if is_state('binary_sensor.multirum_sostoianie','on')%} 
                   {% set time = ([x, y, z]|max) %} 
                   {{as_timestamp(as_datetime(time))| timestamp_custom('%-M:%S') }} • Везде
                 {% else %} {{as_timestamp(as_datetime(z))| timestamp_custom('%-M:%S') }}
                 {% endif %}
              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Бездействие

              {% endif %}
            icon: ""
            entity: media_player.yandex_station_purple
            picture: ""
            badge_icon: ""
            badge_color: ""
            icon_color: ""
            double_tap_action:
              action: none
            fill_container: true
            hold_action:
              action: none
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/lite
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state(config.entity, 'unavailable') %}
                  mdi:alert-circle

                  {% else %} 
                    {% if is_state_attr(config.entity,'alice_state', 'LISTENING') %} mdi:ear-hearing 
                    {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
                    {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
                    {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
                    {% else %} mdi:sleep
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %}1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_purple
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
        visibility:
          - condition: state
            entity: media_player.yandex_station_purple
            state_not: playing
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: yandex:station-mini-2
            entity: media_player.yandex_station_purple
            picture: "{{state_attr(config.entity, 'entity_picture_local')}}"
            badge_icon: ""
            badge_color: ""
            icon_color: white
            tap_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            layout: horizontal
            hold_action:
              action: none
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:24px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'playing')%}
                        {% if state_attr(config.entity,'media_duration') != None %}
                        background: 
                             {% set min = 0.00001 %}  
                             {% set max = state_attr(config.entity,'media_duration')|int(0) %}
                             {% set x = state_attr(config.entity,'media_position')|int(0) %}
                             {% set z = 100 * ( x - min ) / ( max - min ) %}
                             {{z|round(2)}}%
                          linear-gradient(90deg, 
                          rgba(204, 0, 255, 1) {{z}}%, 
                          rgba(204, 0, 255, 0.5) 0.1%) !important;
                        {% else %} 
                         background: rgb(120,120,120)   
                        {% endif %}
                   {% else %}
                   {% endif %}


                  }  
          - type: custom:mushroom-template-card
            primary: |+
              {% if is_state(config.entity, 'playing') %} 
                {% if state_attr(config.entity,'media_title') is none %} Неизвестно
                {% else%} {{state_attr(config.entity, 'media_title')}}
                {% endif %}
              {% else %} Станция Лайт
              {% endif %}




            secondary: >-
              {% set g =
              state_attr('media_player.yandex_station_m00en2100jayck','media_position')|float(0)|round(0)
              %}

              {% set b =
              state_attr('media_player.yandex_station_beige','media_position')|float(0)|round(0)
              %}

              {% set p =
              state_attr('media_player.yandex_station_purple','media_position')|float(0)|round(0)
              %}

              {% set c =
              state_attr('media_player.yandex_station_cyan','media_position')|float(0)|round(0)
              %}


              {% if is_state(config.entity, 'playing') %}
                 {% if is_state('binary_sensor.multirum_sostoianie','on')%} 
                   {% set time = ([g, b, p, c]|max) %} 
                   {{as_timestamp(as_datetime(time))| timestamp_custom('%-M:%S') }} • Везде
                 {% else %} {{as_timestamp(as_datetime(p))| timestamp_custom('%-M:%S') }}
                 {% endif %}
              {% elif is_state(config.entity, 'unavailable') %} Недоступно

              {% else %} Бездействие

              {% endif %}
            icon: ""
            entity: media_player.yandex_station_purple
            picture: ""
            badge_icon: ""
            badge_color: 17,17,17
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            fill_container: true
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/lite
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if is_state(config.entity, 'unavailable') %}
                  mdi:alert-circle

                  {% else %} 
                    {% if is_state_attr(config.entity, 'alice_state', 'LISTENING') %} mdi:ear-hearing 
                    {% elif is_state_attr(config.entity, 'source', 'SamsungTV') %} mdi:television
                    {% elif is_state_attr(config.entity, 'alice_state', 'SPEAKING') %} mdi:account-voice
                    {% elif is_state(config.entity, 'playing') %} mdi:speaker-wireless
                    {% else %} mdi:sleep
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_purple
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  left: 45px !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: mdi:skip-previous
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_previous_track
                  target:
                    entity_id:
                      - media_player.yandex_station_purple
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 75px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: |-
                  {% if is_state(config.entity, 'paused')%}mdi:play
                  {% elif is_state(config.entity, 'playing')%}mdi:pause
                  {% else %} mdi:lock
                  {% endif %}
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_play_pause
                  target:
                    entity_id: media_player.yandex_station_purple
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: media_player.yandex_station_purple
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 40px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon_color: ""
                icon: mdi:skip-next
                tap_action:
                  action: perform-action
                  perform_action: media_player.media_next_track
                  target:
                    entity_id: media_player.yandex_station_purple
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: justify
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0px;
                  right: 5px;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 6
          rows: auto
        visibility:
          - condition: state
            entity: media_player.yandex_station_purple
            state: playing
      - type: custom:vertical-stack-in-card
        cards:
          - show_state: false
            show_name: false
            camera_view: auto
            aspect_ratio: 55%
            type: picture-entity
            camera_image: camera.prikhozhaia
            entity: camera.prikhozhaia
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_prih
            hold_action:
              action: none
            card_mod:
              style: |
                ha-card {
                  height: 112px !important;
                  bottom: 0px !important;
                  left: 0px !important;
                  background-color: rgba(0,0,0,0.5) !important;
          - type: custom:mushroom-template-card
            primary: Прихожая
            secondary: Камера
            icon: ""
            entity: camera.prikhozhaia
            tap_action:
              action: navigate
              navigation_path: /dashboard-iphone/cam_prih
            picture: ""
            icon_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  width:100%;
                  bottom: 0px !important;
                  left: 0px !important;
                  background-color: rgba(var(--rgb-card-background-color), 0.5);
                  }
                ha-card:hover { 
                  background-color: rgba(var(--rgb-card-background-color), 0.7);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: |2-
                   {% if states(config.entity) in ['unknown', 'unavailable', 'none']  %} mdi:alert-circle
                   {% elif is_state(config.entity,'on')%} mdi:run-fast
                   {% else %} 
                   {% endif %}
                icon_color: >-
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']  %} red 

                  {% elif is_state(config.entity,'on')%} 1 

                  {% else %}  

                  {% endif %}
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.motion_enter_occupancy
            alignment: start
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  bottom: 8px !important;
                  right: 0px; !important;
                  --chip-background:  none !important;
                  --chip-height: 40px !important;
        grid_options:
          columns: 6
          rows: auto
        visibility:
          - condition: screen
            media_query: "(min-width: 1280px)"
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} mdi:run-fast
              {% else %} mdi:run
              {% endif %}
            entity: binary_sensor.motion_enter_occupancy
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Движение
            secondary: |-
              {% if is_state(config.entity, 'unavailable')%} Недоступно
              {% else %}

                 {% set time = as_timestamp(now()) - as_timestamp(states.binary_sensor.motion_enter_occupancy.last_changed) %}
                 {% set days = (time // 86400) | int(0)%}
                 {% set hours = (time % 86400) // 3600 | int(0)%}
                 {% set minutes = ((time % 86400) % 3600) //60 | int(0)%}
                 {% set seconds = ((((time % 86400) % 3600) % 60)) | int(0) %}

                 {% if days > 370%} Более года назад
                 {% elif days > 185%} Более полугода назад
                 {% elif days > 95%} Более трёх месяцев назад
                 {% elif days > 62%} Более двух месяцев назад
                 {% elif days > 31%} Более месяца назад
                 {% elif days > 0 %} {{days| round()|format(morph='день', as_text=false) }} назад
                 {% elif days == 0 %}
                   {% if hours > 0 %} {{hours| round()|format(morph='час', as_text=false) }} назад
                   {% elif hours == 0 %}
                     {% if minutes > 0 %} {{minutes | round()|format(morph='минуту', as_text=false) }} назад
                     {% elif minutes == 0 %}
                       {% if seconds == 0 %} Только что
                       {% elif seconds > 0 %} {{seconds| round()|format(morph='секунду', as_text=false) }} назад
                       {% else %} Неизвестно
                       {% endif %}
                     {% endif %}
                   {% else %} 
                   {% endif %}
                 {% else %} 
                 {% endif %}
              {% endif %}
            icon: ""
            entity: binary_sensor.motion_enter_occupancy
            badge_icon: ""
            badge_color: ""
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: ""
            tap_action:
              action: more-info
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% set x = config.entity %}

                  {% set y = x | replace("binary_","") |
                  replace("_occupancy","_battery")%}


                  {% if states(x) in ['unknown', 'unavailable', 'none']%}
                  mdi:alert-circle

                  {% elif states(y)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.motion_enter_occupancy
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: |-
              {% if is_state(config.entity, 'on')%} fas:door-open
              {% else %} fas:door-closed
              {% endif%}
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            hold_action:
              action: none
            entity: binary_sensor.open_exit_contact
            tap_action:
              action: more-info
            picture: ""
            double_tap_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-template-card
            primary: Дверь
            secondary: |
              {% if is_state(config.entity, 'on')%} Открыто
              {% elif is_state(config.entity, 'off')%} Закрыто
              {% else %} Неизвестно
              {% endif %}
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: more-info
            hold_action:
              action: none
            entity: binary_sensor.open_exit_contact
            card_mod:
              style: |
                ha-card:hover { 
                  background-color: rgba(var(--rgb-primary-text-color), 0.05);
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >-
                  {% if states('binary_sensor.zamok_contact') in ['unknown',
                  'unavailable', 'none']  %} mdi:alert-circle

                  {% elif states('binary_sensor.zamok_indoor_contact') in
                  ['unknown', 'unavailable', 'none'] %} mdi:alert-circle

                  {% elif states('binary_sensor.zamok_indoor_battery')|int(100)
                  <= 20 %} fas:battery-quarter

                  {% elif states('binary_sensor.zamok_battery')|int(100) <= 20
                  %} fas:battery-quarter

                  {% else %}
                    {% if is_state('binary_sensor.vkhodnoi_zamok', 'off') %} 
                      {% if is_state('binary_sensor.zamok_indoor_contact', 'off')%} mdi:account-lock
                      {% else %} mdi:lock
                      {% endif %}
                    {% else %} mdi:lock-open-variant
                    {% endif %}
                  {% endif %}
                icon_color: >-
                  {% if states('binary_sensor.zamok_contact') in ['unknown',
                  'unavailable', 'none']  %} red

                  {% elif states('binary_sensor.zamok_indoor_contact') in
                  ['unknown', 'unavailable', 'none'] %} red

                  {% elif states('binary_sensor.zamok_indoor_battery')|int(100)
                  <= 20 %} red

                  {% elif states('binary_sensor.zamok_battery')|int(100) <= 20
                  %} red

                  {% else %} 1

                  {% endif %}
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: binary_sensor.vkhodnoi_zamok
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:bell-ring
            entity: event.button_action
            badge_icon: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            icon_color: "1"
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                   {% if is_state(config.entity,'on') %}
                   
                    background: rgba({{state_attr('light.theme_color_s','rgb_color')|replace ("(","")|replace (")","")}},0.4);
                  {% else %} {% endif %}

                  }  
          - type: custom:mushroom-entity-card
            icon: ""
            entity: event.button_action
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: none
            icon_type: none
            name: Звонок
            secondary_info: last-changed
            icon_color: ""
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: >
                  {% if states(config.entity) in ['unknown', 'unavailable',
                  'none']%} mdi:alert-circle

                  {% elif states(config.entity)|int <= 20%} fas:battery-quarter

                  {% else %} 

                  {% endif %}
                icon_color: red
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: sensor.button_battery
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
    column_span: 6
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: light.vsia_gostinaia
                state_not: "122443"
            chip:
              type: template
              content: Календари
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
        layout_options:
          grid_columns: full
        card_mod:
          style: |
            ha-card {
              margin: 12px 0px 0px;
              --chip-background: none;
              --chip-border-width: 0;
              --chip-box-shadow: none;
              --chip-border-radius: 12px;
              --chip-height: 40px;
              --chip-padding: 14px;
              --chip-spacing: -35px;
              --chip-icon-size: 0.28em;
              --chip-font-size: 0.7em;
            }
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: "      {{state_attr(config.entity, 'friendly_name') }}"
            secondary: |2-
                    {% if is_state(config.entity, 'unavailable') %} Неизвестно

                    {% elif((now().date() + timedelta(days=0)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    СЕГОДНЯ

                    {% elif((now().date() + timedelta(days=1)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    ЗАВТРА 

                    {% else %} 

                    {% endif%}
            icon: mdi:calendar
            badge_icon: ""
            tap_action:
              action: none
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            entity: calendar.1home
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                    background-color: rgba(0, 96, 207,0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if state_attr(config.entity,'start_time') is defined %}

                   {% if is_state(config.entity, 'unavailable') %} Неизвестно
                   {% elif (((now().date() + timedelta(days=0)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}
                  {{state_attr(config.entity, 'message')}}
                  {% else %} Нет событий
                  {% endif %}
               {% else %} Нет событий
               {% endif%}
            secondary: |2+
               {% if is_state(config.entity, 'unavailable') %} Неизвестно
               {% elif (((now().date() + timedelta(days=0)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}




              {% if state_attr(config.entity,'start_time') is defined %}
                {%- set date = as_timestamp(state_attr(config.entity,'start_time')) -%}
                {%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}
                {%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}
                {%- set month = month_list[m_ok-1] %}
                {% set start = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%H:%M') %}
                {% set end = as_timestamp(as_datetime(state_attr(config.entity,'end_time')))| timestamp_custom('%H:%M') %}
                {% set start_day = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%d') %}
                {% if start == end %} {{ start_day }} {{month }} весь день
                {% else %}
                c {{start}} по {{ end }}
                {% endif %}
              {% else %} Пусто
              {% endif %}

               {% else %} Пусто
               {% endif%}




            icon: ""
            badge_icon: ""
            tap_action:
              action: none
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            entity: calendar.1home
            card_mod:
              style: |
                ha-card { 


                }
        grid_options:
          columns: 6
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: "      {{state_attr(config.entity, 'friendly_name') }}"
            secondary: |2-
                    {% if is_state(config.entity, 'unavailable') %} Неизвестно

                    {% elif((now().date() + timedelta(days=0)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    СЕГОДНЯ

                    {% elif((now().date() + timedelta(days=1)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    ЗАВТРА 

                    {% else %} 

                    {% endif%}
            icon: mdi:calendar
            badge_icon: ""
            tap_action:
              action: none
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            entity: calendar.work_s
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                    background-color: rgba(207, 110, 0, 0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if state_attr(config.entity,'start_time') is defined %}

                   {% if is_state(config.entity, 'unavailable') %} Неизвестно
                   {% elif (((now().date() + timedelta(days=0)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}
                  {{state_attr(config.entity, 'message')}}
                  {% else %} Нет событий
                  {% endif %}
               {% else %} Нет событий
               {% endif%}
            secondary: |2+
               {% if is_state(config.entity, 'unavailable') %} Неизвестно
               {% elif (((now().date() + timedelta(days=0)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}




              {% if state_attr(config.entity,'start_time') is defined %}
                {%- set date = as_timestamp(state_attr(config.entity,'start_time')) -%}
                {%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}
                {%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}
                {%- set month = month_list[m_ok-1] %}
                {% set start = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%H:%M') %}
                {% set end = as_timestamp(as_datetime(state_attr(config.entity,'end_time')))| timestamp_custom('%H:%M') %}
                {% set start_day = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%d') %}
                {% if start == end %} {{ start_day }} {{month }} весь день
                {% else %}
                c {{start}} по {{ end }}
                {% endif %}
              {% else %} Пусто
              {% endif %}

               {% else %} Пусто
               {% endif%}




            icon: ""
            badge_icon: ""
            tap_action:
              action: none
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            entity: calendar.work_s
            card_mod:
              style: |
                ha-card { 


                }
        grid_options:
          columns: 6
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: "      {{state_attr(config.entity, 'friendly_name') }}"
            secondary: |2-
                    {% if is_state(config.entity, 'unavailable') %} Неизвестно

                    {% elif((now().date() + timedelta(days=0)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    СЕГОДНЯ

                    {% elif((now().date() + timedelta(days=1)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    ЗАВТРА 

                    {% else %} 

                    {% endif%}
            icon: mdi:calendar
            badge_icon: ""
            tap_action:
              action: none
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            entity: calendar.melkaia
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                    background-color: rgba(207, 0, 186, 0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if state_attr(config.entity,'start_time') is defined %}

                   {% if is_state(config.entity, 'unavailable') %} Неизвестно
                   {% elif (((now().date() + timedelta(days=0)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}
                  {{state_attr(config.entity, 'message')}}
                  {% else %} Нет событий
                  {% endif %}
               {% else %} Нет событий
               {% endif%}
            secondary: |2+
               {% if is_state(config.entity, 'unavailable') %} Неизвестно
               {% elif (((now().date() + timedelta(days=0)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}




              {% if state_attr(config.entity,'start_time') is defined %}
                {%- set date = as_timestamp(state_attr(config.entity,'start_time')) -%}
                {%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}
                {%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}
                {%- set month = month_list[m_ok-1] %}
                {% set start = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%H:%M') %}
                {% set end = as_timestamp(as_datetime(state_attr(config.entity,'end_time')))| timestamp_custom('%H:%M') %}
                {% set start_day = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%d') %}
                {% if start == end %} {{ start_day }} {{month }} весь день
                {% else %}
                c {{start}} по {{ end }}
                {% endif %}
              {% else %} Пусто
              {% endif %}

               {% else %} Пусто
               {% endif%}




            icon: ""
            badge_icon: ""
            tap_action:
              action: none
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            entity: calendar.melkaia
            card_mod:
              style: |
                ha-card { 


                }
        grid_options:
          columns: 6
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: "      {{state_attr(config.entity, 'friendly_name') }}"
            secondary: |2-
                    {% if is_state(config.entity, 'unavailable') %} Неизвестно

                    {% elif((now().date() + timedelta(days=0)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    СЕГОДНЯ

                    {% elif((now().date() + timedelta(days=1)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    ЗАВТРА 

                    {% else %} 

                    {% endif%}
            icon: mdi:calendar
            badge_icon: ""
            tap_action:
              action: none
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            entity: calendar.work_m
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                    background-color: rgba(165, 0, 207, 0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if state_attr(config.entity,'start_time') is defined %}

                   {% if is_state(config.entity, 'unavailable') %} Неизвестно
                   {% elif (((now().date() + timedelta(days=0)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}
                  {{state_attr(config.entity, 'message')}}
                  {% else %} Нет событий
                  {% endif %}
               {% else %} Нет событий
               {% endif%}
            secondary: |2+
               {% if is_state(config.entity, 'unavailable') %} Неизвестно
               {% elif (((now().date() + timedelta(days=0)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}




              {% if state_attr(config.entity,'start_time') is defined %}
                {%- set date = as_timestamp(state_attr(config.entity,'start_time')) -%}
                {%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}
                {%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}
                {%- set month = month_list[m_ok-1] %}
                {% set start = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%H:%M') %}
                {% set end = as_timestamp(as_datetime(state_attr(config.entity,'end_time')))| timestamp_custom('%H:%M') %}
                {% set start_day = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%d') %}
                {% if start == end %} {{ start_day }} {{month }} весь день
                {% else %}
                c {{start}} по {{ end }}
                {% endif %}
              {% else %} Пусто
              {% endif %}

               {% else %} Пусто
               {% endif%}




            icon: ""
            badge_icon: ""
            tap_action:
              action: none
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            entity: calendar.work_m
            card_mod:
              style: |
                ha-card { 


                }
        grid_options:
          columns: 6
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: "      {{state_attr(config.entity, 'friendly_name') }}"
            secondary: |2-
                    {% if is_state(config.entity, 'unavailable') %} Неизвестно

                    {% elif((now().date() + timedelta(days=0)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    СЕГОДНЯ

                    {% elif((now().date() + timedelta(days=1)) ==
                    as_datetime(state_attr(config.entity, 'start_time')).date()) == True %}
                    ЗАВТРА 

                    {% else %} 

                    {% endif%}
            icon: mdi:calendar
            badge_icon: ""
            tap_action:
              action: none
            icon_color: "1"
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            layout: horizontal
            entity: calendar.5birthday
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symb1ol-size:2000px;
                  }
                .: |
                  ha-card { 

                    background-color: rgba(0, 152, 186, 0.4);


                  }  
          - type: custom:mushroom-template-card
            primary: |-
              {% if state_attr(config.entity,'start_time') is defined %}

                   {% if is_state(config.entity, 'unavailable') %} Неизвестно
                   {% elif (((now().date() + timedelta(days=0)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
                   as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}
                  {{state_attr(config.entity, 'message')}}
                  {% else %} Нет событий
                  {% endif %}
               {% else %} Нет событий
               {% endif%}
            secondary: |2+
               {% if is_state(config.entity, 'unavailable') %} Неизвестно
               {% elif (((now().date() + timedelta(days=0)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) or (((now().date() + timedelta(days=1)) ==
               as_datetime(state_attr(config.entity, 'start_time')).date()) == True) %}




              {% if state_attr(config.entity,'start_time') is defined %}
                {%- set date = as_timestamp(state_attr(config.entity,'start_time')) -%}
                {%- set month_list = ['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'] %}
                {%- set m_ok = date | timestamp_custom("%m",true,0) | int(0) %}
                {%- set month = month_list[m_ok-1] %}
                {% set start = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%H:%M') %}
                {% set end = as_timestamp(as_datetime(state_attr(config.entity,'end_time')))| timestamp_custom('%H:%M') %}
                {% set start_day = as_timestamp(as_datetime(state_attr(config.entity,'start_time')))| timestamp_custom('%d') %}
                {% if start == end %} {{ start_day }} {{month }} весь день
                {% else %}
                c {{start}} по {{ end }}
                {% endif %}
              {% else %} Пусто
              {% endif %}

               {% else %} Пусто
               {% endif%}




            icon: ""
            badge_icon: ""
            tap_action:
              action: none
            icon_color: ""
            layout: horizontal
            double_tap_action:
              action: none
            badge_color: ""
            fill_container: true
            picture: ""
            hold_action:
              action: none
            entity: calendar.5birthday
            card_mod:
              style: |
                ha-card { 


                }
        grid_options:
          columns: 6
          rows: auto
    column_span: 6
    visibility:
      - condition: screen
        media_query: "(min-width: 1280px)"
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: light.vsia_gostinaia
                state_not: "122443"
            chip:
              type: template
              content: Сценарии
              double_tap_action:
                action: none
              tap_action:
                action: none
              hold_action:
                action: none
        layout_options:
          grid_columns: full
        card_mod:
          style: |
            ha-card {
              margin: 12px 0px 0px;
              --chip-background: none;
              --chip-border-width: 0;
              --chip-box-shadow: none;
              --chip-border-radius: 12px;
              --chip-height: 40px;
              --chip-padding: 14px;
              --chip-spacing: -35px;
              --chip-icon-size: 0.28em;
              --chip-font-size: 0.7em;
            }
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:bed-clock
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: automation.trigger
              data:
                skip_condition: true
              target:
                entity_id: automation.alisa_dobroe_utro
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(0, 85, 255, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Доброе утро
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: automation.trigger
              data:
                skip_condition: true
              target:
                entity_id: automation.alisa_dobroe_utro
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: automation.trigger
                  data:
                    skip_condition: true
                  target:
                    entity_id: automation.alisa_dobroe_utro
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:sleep
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: perform-action
              perform_action: automation.trigger
              data:
                skip_condition: true
              target:
                entity_id: automation.spat
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(26, 41, 71, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Спать
            secondary: Удержать
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: perform-action
              perform_action: automation.trigger
              data:
                skip_condition: true
              target:
                entity_id: automation.spat
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: none
                hold_action:
                  action: perform-action
                  perform_action: automation.trigger
                  data:
                    skip_condition: true
                  target:
                    entity_id: automation.spat
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:play-circle
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.1668202079285
              target: {}
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(204, 0, 255, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Мультирум
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.1668202079285
              target: {}
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: script.1668202079285
                  target: {}
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:palette
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.1684868061399
              target: {}
            hold_action:
              action: none
            picture: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(255, 0, 0, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Красный
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.1684868061399
              target: {}
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: script.1684868061399
                  target: {}
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:palette
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.unknown_3
              target: {}
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: #d694ff66;
                  }  
          - type: custom:mushroom-template-card
            primary: Светло-сиреневый
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.unknown_3
              target: {}
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: script.unknown_3
                  target: {}
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:palette
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.unknown_2
              target: {}
            hold_action:
              action: none
            picture: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(191, 139, 85, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Бежевый
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.unknown_2
              target: {}
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: script.unknown_2
                  target: {}
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:palette
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.unknown_2
              target: {}
            hold_action:
              action: none
            picture: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(255, 120, 0, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Тёплый
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.unknown_6
              target: {}
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: script.unknown_6
                  target: {}
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:palette
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.1684867242034
              target: {}
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(0, 238, 255, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Бирюзовый
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.1684867242034
              target: {}
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: script.1684867242034
                  target: {}
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:palette
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.1684867088872
              target: {}
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(0, 0, 255, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Синий
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: script.1684867088872
              target: {}
            hold_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: script.1684867088872
                  target: {}
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            fill_container: true
            tap_action:
              action: perform-action
              perform_action: script.1715290120672
              target: {}
            hold_action:
              action: none
            secondary_info: none
            primary_info: none
            icon: mdi:lightbulb-group-outline
            icon_color: |
              1
            badge_color: ""
            primary: ""
            secondary: ""
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(255, 213, 0, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Яркость 1%
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: script.1715290120672
                  target: {}
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:lightbulb-alert
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: perform-action
              perform_action: automation.trigger
              target:
                entity_id: automation.vkliuchit_utrom_dekor
              data:
                skip_condition: true
            hold_action:
              action: none
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(255, 136, 0, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: Декор вкл.
            secondary: Запустить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:play
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: automation.trigger
                  target:
                    entity_id: automation.vkliuchit_utrom_dekor
                  data:
                    skip_condition: true
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: ""
            secondary: ""
            icon: mdi:hdmi-port
            fill_container: true
            badge_icon: ""
            icon_color: "1"
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            layout: horizontal
            entity: input_select.pk_istochnik
            card_mod:
              style:
                mushroom-shape-icon$: |
                  .shape {
                    --shape-colo1r: none !important;
                    --icon-symbol-size:30px;
                  }
                .: |
                  ha-card { 
                    background: rgba(0, 65, 84, 0.4);
                  }  
          - type: custom:mushroom-template-card
            primary: ТВ HDMI
            secondary: Сменить
            icon: ""
            fill_container: true
            badge_icon: ""
            icon_color: ""
            badge_color: ""
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
            entity: input_select.pk_istochnik
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:skip-next
                icon_color: "1"
                tap_action:
                  action: perform-action
                  perform_action: remote.send_command
                  data:
                    command: KEY_HDMI
                  target:
                    entity_id: remote.televizor
                hold_action:
                  action: none
                double_tap_action:
                  action: none
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  top: 0% !important;
                  right: 0% !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        grid_options:
          columns: 3
          rows: auto
    column_span: 6
